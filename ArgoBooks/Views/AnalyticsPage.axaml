<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:ArgoBooks.ViewModels"
             xmlns:controls="using:ArgoBooks.Controls"
             xmlns:lvc="using:LiveChartsCore.SkiaSharpView.Avalonia"
             mc:Ignorable="d" d:DesignWidth="1400" d:DesignHeight="900"
             x:Class="ArgoBooks.Views.AnalyticsPage"
             x:DataType="vm:AnalyticsPageViewModel">

    <Design.DataContext>
        <vm:AnalyticsPageViewModel />
    </Design.DataContext>

    <Grid RowDefinitions="Auto,*">
        <!-- Header Bar with Date Range and Tabs -->
        <Border Grid.Row="0"
                Background="{DynamicResource SurfaceBrush}"
                BorderBrush="{DynamicResource BorderBrush}"
                BorderThickness="0,0,0,1"
                ClipToBounds="False">
            <Grid RowDefinitions="Auto,Auto" ClipToBounds="False">
                <!-- Top Row: Date Range Selector -->
                <Border Grid.Row="0"
                        Padding="24,16"
                        BorderBrush="{DynamicResource BorderBrush}"
                        BorderThickness="0,0,0,1">
                    <Grid ColumnDefinitions="*,Auto">
                        <!-- Page Title -->
                        <TextBlock Grid.Column="0"
                                   Text="Analytics"
                                   FontSize="20"
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource TextPrimaryBrush}"
                                   VerticalAlignment="Center" />

                        <!-- Date Range Controls -->
                        <StackPanel Grid.Column="1"
                                    Orientation="Horizontal"
                                    Spacing="12">
                            <!-- Date Range Dropdown -->
                            <ComboBox ItemsSource="{Binding DateRangeOptions}"
                                      SelectedItem="{Binding SelectedDateRange}"
                                      Classes="form-combobox"
                                      Width="150" />

                            <!-- Custom Date Range (visible when Custom is selected) -->
                            <StackPanel Orientation="Horizontal"
                                        Spacing="8"
                                        IsVisible="{Binding IsCustomDateRange}">
                                <Border Background="{DynamicResource SurfaceAltBrush}"
                                        CornerRadius="6"
                                        Padding="8,6">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <PathIcon Data="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM9 10H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm-8 4H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2z"
                                                  Width="16" Height="16"
                                                  Foreground="{DynamicResource TextSecondaryBrush}" />
                                        <TextBlock Text="{Binding StartDate, StringFormat='{}{0:MMM dd, yyyy}'}"
                                                   FontSize="13"
                                                   Foreground="{DynamicResource TextPrimaryBrush}"
                                                   VerticalAlignment="Center" />
                                    </StackPanel>
                                </Border>
                                <TextBlock Text="to"
                                           FontSize="13"
                                           Foreground="{DynamicResource TextSecondaryBrush}"
                                           VerticalAlignment="Center" />
                                <Border Background="{DynamicResource SurfaceAltBrush}"
                                        CornerRadius="6"
                                        Padding="8,6">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <PathIcon Data="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM9 10H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm-8 4H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2z"
                                                  Width="16" Height="16"
                                                  Foreground="{DynamicResource TextSecondaryBrush}" />
                                        <TextBlock Text="{Binding EndDate, StringFormat='{}{0:MMM dd, yyyy}'}"
                                                   FontSize="13"
                                                   Foreground="{DynamicResource TextPrimaryBrush}"
                                                   VerticalAlignment="Center" />
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Tab Bar with Chart Type Toggle -->
                <Grid Grid.Row="1" ColumnDefinitions="*,Auto" ClipToBounds="False">
                    <!-- Analytics Tabs -->
                    <TabControl Grid.Column="0"
                                SelectedIndex="{Binding SelectedTabIndex}"
                                Classes="page-tabs">
                        <TabItem Header="Dashboard" />
                        <TabItem Header="Geographic" />
                        <TabItem Header="Operational" />
                        <TabItem Header="Performance" />
                        <TabItem Header="Customers" />
                        <TabItem Header="Returns" />
                        <TabItem Header="Losses" />
                    </TabControl>

                    <!-- Chart Type Toggle -->
                    <StackPanel Grid.Column="1"
                                Orientation="Horizontal"
                                Spacing="8"
                                Margin="0,0,24,0"
                                VerticalAlignment="Center"
                                ClipToBounds="False"
                                IsVisible="{Binding !IsGeographicTabSelected}">
                        <TextBlock Text="Line Chart"
                                   FontSize="13"
                                   Foreground="{DynamicResource TextSecondaryBrush}"
                                   VerticalAlignment="Center" />
                        <ToggleSwitch IsChecked="{Binding UseLineChart}"
                                      OnContent=""
                                      Margin="0,0,0,8"
                                      OffContent=""
                                      Classes="chart-toggle" />
                    </StackPanel>
                </Grid>
            </Grid>
        </Border>

        <!-- Main Content Area -->
        <ScrollViewer Grid.Row="1"
                      VerticalScrollBarVisibility="Auto"
                      HorizontalScrollBarVisibility="Disabled"
                      Background="{DynamicResource BackgroundSecondaryBrush}">
            <Panel>
                <!-- Dashboard Tab Content -->
                <StackPanel Margin="24" Spacing="24"
                            IsVisible="{Binding IsDashboardTabSelected}">
                    <!-- Stats Grid -->
                    <UniformGrid Columns="4" Rows="1">
                        <controls:StatCard Label="Total Purchases"
                                           Value="$45,234"
                                           Icon="M19 14V6c0-1.1-.9-2-2-2H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zm-9-1c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm13-6v11c0 1.1-.9 2-2 2H4v-2h17V7h2z"
                                           IconColor="Danger"
                                           ChangeValue="-3.2"
                                           ChangeText="3.2%"
                                           Margin="0,0,12,0" />
                        <controls:StatCard Label="Total Sales"
                                           Value="$124,563"
                                           Icon="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1.41 16.09V20h-2.67v-1.93c-1.71-.36-3.16-1.46-3.27-3.4h1.96c.1 1.05.82 1.87 2.65 1.87 1.96 0 2.4-.98 2.4-1.59 0-.83-.44-1.61-2.67-2.14-2.48-.6-4.18-1.62-4.18-3.67 0-1.72 1.39-2.84 3.11-3.21V4h2.67v1.95c1.86.45 2.79 1.86 2.85 3.39H14.3c-.05-1.11-.64-1.87-2.22-1.87-1.5 0-2.4.68-2.4 1.64 0 .84.65 1.39 2.67 1.91s4.18 1.39 4.18 3.91c-.01 1.83-1.38 2.83-3.12 3.16z"
                                           IconColor="Success"
                                           ChangeValue="12.5"
                                           ChangeText="12.5%"
                                           Margin="0,0,12,0" />
                        <controls:StatCard Label="Net Profit"
                                           Value="$79,329"
                                           Icon="M11 17h2v-6h-2v6zm1-15C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zM11 9h2V7h-2v2z"
                                           IconColor="Primary"
                                           ChangeValue="18.7"
                                           ChangeText="18.7%"
                                           Margin="0,0,12,0" />
                        <controls:StatCard Label="Profit Margin"
                                           Value="63.7%"
                                           Icon="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"
                                           IconColor="Info"
                                           ChangeValue="4.2"
                                           ChangeText="4.2%" />
                    </UniformGrid>

                    <!-- Charts Row 1: Purchases -->
                    <Grid ColumnDefinitions="*,*" Height="300">
                        <!-- Purchase Trends Chart -->
                        <Border Grid.Column="0"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="0,0,12,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Purchase Trends"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Chart with data -->
                                        <lvc:CartesianChart Series="{Binding ExpensesTrendsSeries}"
                                                            XAxes="{Binding ExpensesTrendsXAxes}"
                                                            YAxes="{Binding ExpensesTrendsYAxes}"
                                                            ZoomMode="X"
                                                            IsVisible="{Binding HasExpensesTrendsData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasExpensesTrendsData}">
                                            <TextBlock Text="No purchase data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>

                        <!-- Purchase Distribution Chart -->
                        <Border Grid.Column="1"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="12,0,0,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Purchase Distribution"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Pie Chart with data -->
                                        <lvc:PieChart Series="{Binding ExpensesDistributionSeries}"
                                                      LegendPosition="Right"
                                                      LegendTextPaint="{Binding LegendTextPaint}"
                                                      IsVisible="{Binding HasExpensesDistributionData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasExpensesDistributionData}">
                                            <TextBlock Text="No distribution data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>
                    </Grid>

                    <!-- Charts Row 2: Sales -->
                    <Grid ColumnDefinitions="*,*" Height="300">
                        <!-- Sales Trends Chart -->
                        <Border Grid.Column="0"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="0,0,12,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Sales Trends"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Chart with data -->
                                        <lvc:CartesianChart Series="{Binding RevenueTrendsSeries}"
                                                            XAxes="{Binding RevenueTrendsXAxes}"
                                                            YAxes="{Binding RevenueTrendsYAxes}"
                                                            ZoomMode="X"
                                                            IsVisible="{Binding HasRevenueTrendsData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasRevenueTrendsData}">
                                            <TextBlock Text="No sales data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>

                        <!-- Sales Distribution Chart -->
                        <Border Grid.Column="1"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="12,0,0,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Sales Distribution"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Pie Chart with data -->
                                        <lvc:PieChart Series="{Binding RevenueDistributionSeries}"
                                                      LegendPosition="Right"
                                                      LegendTextPaint="{Binding LegendTextPaint}"
                                                      IsVisible="{Binding HasRevenueDistributionData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasRevenueDistributionData}">
                                            <TextBlock Text="No distribution data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>
                    </Grid>

                    <!-- Charts Row 3: Profit Analysis -->
                    <Grid ColumnDefinitions="*,*" Height="300">
                        <!-- Profit Trends Chart -->
                        <Border Grid.Column="0"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="0,0,12,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Profit Over Time"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Chart with data -->
                                        <lvc:CartesianChart Series="{Binding ProfitTrendsSeries}"
                                                            XAxes="{Binding ProfitTrendsXAxes}"
                                                            YAxes="{Binding ProfitTrendsYAxes}"
                                                            ZoomMode="X"
                                                            IsVisible="{Binding HasProfitTrendsData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasProfitTrendsData}">
                                            <TextBlock Text="No profit data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>

                        <!-- Sales vs Expenses Chart -->
                        <Border Grid.Column="1"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="12,0,0,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Sales vs Expenses"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Chart with data -->
                                        <lvc:CartesianChart Series="{Binding SalesVsExpensesSeries}"
                                                            XAxes="{Binding SalesVsExpensesXAxes}"
                                                            YAxes="{Binding SalesVsExpensesYAxes}"
                                                            ZoomMode="X"
                                                            IsVisible="{Binding HasSalesVsExpensesData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasSalesVsExpensesData}">
                                            <TextBlock Text="No comparison data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>
                    </Grid>
                </StackPanel>

                <!-- Geographic Tab Content -->
                <StackPanel Margin="24" Spacing="24"
                            IsVisible="{Binding IsGeographicTabSelected}">
                    <!-- Row 1: Countries/Companies of Origin -->
                    <Grid ColumnDefinitions="*,*" Height="300">
                        <!-- Countries of Origin Chart -->
                        <Border Grid.Column="0"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="0,0,12,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Countries of Origin"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Pie Chart with data -->
                                        <lvc:PieChart Series="{Binding CountriesOfOriginSeries}"
                                                      LegendPosition="Right"
                                                      LegendTextPaint="{Binding LegendTextPaint}"
                                                      IsVisible="{Binding HasCountriesOfOriginData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasCountriesOfOriginData}">
                                            <TextBlock Text="No country data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>

                        <!-- Companies of Origin Chart -->
                        <Border Grid.Column="1"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="12,0,0,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Companies of Origin"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Pie Chart with data -->
                                        <lvc:PieChart Series="{Binding CompaniesOfOriginSeries}"
                                                      LegendPosition="Right"
                                                      LegendTextPaint="{Binding LegendTextPaint}"
                                                      IsVisible="{Binding HasCompaniesOfOriginData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasCompaniesOfOriginData}">
                                            <TextBlock Text="No company data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>
                    </Grid>

                    <!-- Row 2: Countries/Companies of Destination -->
                    <Grid ColumnDefinitions="*,*" Height="300">
                        <!-- Countries of Destination Chart -->
                        <Border Grid.Column="0"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="0,0,12,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Countries of Destination"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Pie Chart with data -->
                                        <lvc:PieChart Series="{Binding CountriesOfDestinationSeries}"
                                                      LegendPosition="Right"
                                                      LegendTextPaint="{Binding LegendTextPaint}"
                                                      IsVisible="{Binding HasCountriesOfDestinationData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasCountriesOfDestinationData}">
                                            <TextBlock Text="No destination data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>

                        <!-- Companies of Destination Chart -->
                        <Border Grid.Column="1"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="12,0,0,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Companies of Destination"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Pie Chart with data -->
                                        <lvc:PieChart Series="{Binding CompaniesOfDestinationSeries}"
                                                      LegendPosition="Right"
                                                      LegendTextPaint="{Binding LegendTextPaint}"
                                                      IsVisible="{Binding HasCompaniesOfDestinationData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasCompaniesOfDestinationData}">
                                            <TextBlock Text="No company data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>
                    </Grid>

                    <!-- Row 3: World Map (Full Width) -->
                    <Border Background="{DynamicResource SurfaceBrush}"
                            BorderBrush="{DynamicResource BorderBrush}"
                            BorderThickness="1"
                            CornerRadius="12"
                            Height="550">
                        <Grid RowDefinitions="Auto,*">
                            <Border Grid.Row="0"
                                    Padding="20,16"
                                    BorderBrush="{DynamicResource BorderBrush}"
                                    BorderThickness="0,0,0,1">
                                <Grid ColumnDefinitions="*,Auto">
                                    <TextBlock Grid.Column="0"
                                               Text="World Map Overview"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextPrimaryBrush}"
                                               VerticalAlignment="Center" />
                                    <!-- Origin/Destination Toggle -->
                                    <Border Grid.Column="1"
                                            Background="{DynamicResource SurfaceAltBrush}"
                                            CornerRadius="6"
                                            Padding="4">
                                        <StackPanel Orientation="Horizontal" Spacing="4">
                                            <RadioButton Content="Origin"
                                                         GroupName="MapMode"
                                                         IsChecked="{Binding IsMapModeOrigin}"
                                                         Classes="segmented-button" />
                                            <RadioButton Content="Destination"
                                                         GroupName="MapMode"
                                                         IsChecked="{Binding IsMapModeDestination}"
                                                         Classes="segmented-button" />
                                        </StackPanel>
                                    </Border>
                                </Grid>
                            </Border>
                            <Border Grid.Row="1" Padding="10">
                                <Panel>
                                    <lvc:GeoMap Series="{Binding GeoMapSeries}"
                                                MapProjection="Mercator"
                                                IsVisible="{Binding HasWorldMapData}" />
                                    <Border Background="{DynamicResource SurfaceAltBrush}"
                                            CornerRadius="8"
                                            IsVisible="{Binding !HasWorldMapData}">
                                        <TextBlock Text="No geographic data available"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   FontSize="14"
                                                   Foreground="{DynamicResource TextTertiaryBrush}" />
                                    </Border>
                                </Panel>
                            </Border>
                        </Grid>
                    </Border>
                </StackPanel>

                <!-- Operational Tab Content -->
                <StackPanel Margin="24" Spacing="24"
                            IsVisible="{Binding IsOperationalTabSelected}">
                    <!-- Stats Grid -->
                    <UniformGrid Columns="4" Rows="1">
                        <controls:StatCard Label="Active Accountants"
                                           Value="8"
                                           Icon="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"
                                           IconColor="Primary"
                                           Margin="0,0,12,0" />
                        <controls:StatCard Label="Transactions Processed"
                                           Value="1,247"
                                           Icon="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 3c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6zm7 13H5v-.23c0-.62.28-1.2.76-1.58C7.47 15.82 9.64 15 12 15s4.53.82 6.24 2.19c.48.38.76.97.76 1.58V19z"
                                           IconColor="Success"
                                           ChangeValue="8.3"
                                           ChangeText="+8.3%"
                                           Margin="0,0,12,0" />
                        <controls:StatCard Label="Avg Processing Time"
                                           Value="2.4 min"
                                           Icon="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"
                                           IconColor="Warning"
                                           ChangeValue="-12.5"
                                           ChangeText="-12.5%"
                                           Margin="0,0,12,0" />
                        <controls:StatCard Label="Accuracy Rate"
                                           Value="99.2%"
                                           Icon="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"
                                           IconColor="Info"
                                           ChangeValue="0.5"
                                           ChangeText="+0.5%" />
                    </UniformGrid>

                    <!-- Charts -->
                    <Grid ColumnDefinitions="*,*" Height="300">
                        <!-- Transactions by Accountant -->
                        <Border Grid.Column="0"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="0,0,12,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Transactions by Accountant"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Pie Chart with data -->
                                        <lvc:PieChart Series="{Binding AccountantsTransactionsSeries}"
                                                      LegendPosition="Right"
                                                      LegendTextPaint="{Binding LegendTextPaint}"
                                                      IsVisible="{Binding HasAccountantsTransactionsData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasAccountantsTransactionsData}">
                                            <TextBlock Text="No accountant data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>

                        <!-- Workload Distribution -->
                        <Border Grid.Column="1"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="12,0,0,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Workload Distribution"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Chart with data -->
                                        <lvc:CartesianChart Series="{Binding TotalTransactionsSeries}"
                                                            XAxes="{Binding TotalTransactionsXAxes}"
                                                            YAxes="{Binding TotalTransactionsYAxes}"
                                                            ZoomMode="X"
                                                            IsVisible="{Binding HasTotalTransactionsData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasTotalTransactionsData}">
                                            <TextBlock Text="No workload data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>
                    </Grid>

                    <!-- Processing Trends -->
                    <Border Background="{DynamicResource SurfaceBrush}"
                            BorderBrush="{DynamicResource BorderBrush}"
                            BorderThickness="1"
                            CornerRadius="12"
                            Height="300">
                        <Grid RowDefinitions="Auto,*">
                            <Border Grid.Row="0"
                                    Padding="20,16"
                                    BorderBrush="{DynamicResource BorderBrush}"
                                    BorderThickness="0,0,0,1">
                                <TextBlock Text="Processing Time Trends"
                                           FontSize="16"
                                           FontWeight="SemiBold"
                                           HorizontalAlignment="Center"
                                           Foreground="{DynamicResource TextPrimaryBrush}" />
                            </Border>
                            <Border Grid.Row="1" Padding="10">
                                <Panel>
                                    <!-- Chart with data -->
                                    <lvc:CartesianChart Series="{Binding AvgTransactionValueSeries}"
                                                        XAxes="{Binding AvgTransactionValueXAxes}"
                                                        YAxes="{Binding AvgTransactionValueYAxes}"
                                                        ZoomMode="X"
                                                        IsVisible="{Binding HasAvgTransactionValueData}" />
                                    <!-- No data placeholder -->
                                    <Border Background="{DynamicResource SurfaceAltBrush}"
                                            CornerRadius="8"
                                            IsVisible="{Binding !HasAvgTransactionValueData}">
                                        <TextBlock Text="No processing data available"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   FontSize="14"
                                                   Foreground="{DynamicResource TextTertiaryBrush}" />
                                    </Border>
                                </Panel>
                            </Border>
                        </Grid>
                    </Border>
                </StackPanel>

                <!-- Performance Tab Content -->
                <StackPanel Margin="24" Spacing="24"
                            IsVisible="{Binding IsPerformanceTabSelected}">
                    <!-- Stats Grid -->
                    <UniformGrid Columns="4" Rows="1">
                        <controls:StatCard Label="Revenue Growth"
                                           Value="18.7%"
                                           Icon="M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"
                                           IconColor="Success"
                                           ChangeValue="5.2"
                                           ChangeText="+5.2%"
                                           Margin="0,0,12,0" />
                        <controls:StatCard Label="Total Transactions"
                                           Value="3,842"
                                           Icon="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 3c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6zm7 13H5v-.23c0-.62.28-1.2.76-1.58C7.47 15.82 9.64 15 12 15s4.53.82 6.24 2.19c.48.38.76.97.76 1.58V19z"
                                           IconColor="Primary"
                                           ChangeValue="12.3"
                                           ChangeText="+12.3%"
                                           Margin="0,0,12,0" />
                        <controls:StatCard Label="Avg Transaction Value"
                                           Value="$324.50"
                                           Icon="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1.41 16.09V20h-2.67v-1.93c-1.71-.36-3.16-1.46-3.27-3.4h1.96c.1 1.05.82 1.87 2.65 1.87 1.96 0 2.4-.98 2.4-1.59 0-.83-.44-1.61-2.67-2.14-2.48-.6-4.18-1.62-4.18-3.67 0-1.72 1.39-2.84 3.11-3.21V4h2.67v1.95c1.86.45 2.79 1.86 2.85 3.39H14.3c-.05-1.11-.64-1.87-2.22-1.87-1.5 0-2.4.68-2.4 1.64 0 .84.65 1.39 2.67 1.91s4.18 1.39 4.18 3.91c-.01 1.83-1.38 2.83-3.12 3.16z"
                                           IconColor="Info"
                                           ChangeValue="3.8"
                                           ChangeText="+3.8%"
                                           Margin="0,0,12,0" />
                        <controls:StatCard Label="Avg Shipping Cost"
                                           Value="$12.45"
                                           Icon="M20 8h-3V4H3c-1.1 0-2 .9-2 2v11h2c0 1.66 1.34 3 3 3s3-1.34 3-3h6c0 1.66 1.34 3 3 3s3-1.34 3-3h2v-5l-3-4zM6 18.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm13.5-9l1.96 2.5H17V9.5h2.5zm-1.5 9c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"
                                           IconColor="Warning"
                                           ChangeValue="-2.1"
                                           ChangeText="-2.1%" />
                    </UniformGrid>

                    <!-- Charts Row 1 -->
                    <Grid ColumnDefinitions="*,*" Height="300">
                        <!-- Average Transaction Value -->
                        <Border Grid.Column="0"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="0,0,12,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Average Transaction Value"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Chart with data -->
                                        <lvc:CartesianChart Series="{Binding AvgTransactionValueSeries}"
                                                            XAxes="{Binding AvgTransactionValueXAxes}"
                                                            YAxes="{Binding AvgTransactionValueYAxes}"
                                                            ZoomMode="X"
                                                            IsVisible="{Binding HasAvgTransactionValueData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasAvgTransactionValueData}">
                                            <TextBlock Text="No transaction data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>

                        <!-- Total Transactions Over Time -->
                        <Border Grid.Column="1"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="12,0,0,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Total Transactions"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Chart with data -->
                                        <lvc:CartesianChart Series="{Binding TotalTransactionsSeries}"
                                                            XAxes="{Binding TotalTransactionsXAxes}"
                                                            YAxes="{Binding TotalTransactionsYAxes}"
                                                            ZoomMode="X"
                                                            IsVisible="{Binding HasTotalTransactionsData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasTotalTransactionsData}">
                                            <TextBlock Text="No transaction data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>
                    </Grid>

                    <!-- Charts Row 2 -->
                    <Grid ColumnDefinitions="*,*" Height="300">
                        <!-- Average Shipping Costs -->
                        <Border Grid.Column="0"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="0,0,12,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Average Shipping Costs"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Chart with data -->
                                        <lvc:CartesianChart Series="{Binding AvgShippingCostsSeries}"
                                                            XAxes="{Binding AvgShippingCostsXAxes}"
                                                            YAxes="{Binding AvgShippingCostsYAxes}"
                                                            ZoomMode="X"
                                                            IsVisible="{Binding HasAvgShippingCostsData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasAvgShippingCostsData}">
                                            <TextBlock Text="No shipping data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>

                        <!-- Growth Rates -->
                        <Border Grid.Column="1"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="12,0,0,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Growth Rates"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Chart with data -->
                                        <lvc:CartesianChart Series="{Binding GrowthRatesSeries}"
                                                            XAxes="{Binding GrowthRatesXAxes}"
                                                            YAxes="{Binding GrowthRatesYAxes}"
                                                            ZoomMode="X"
                                                            IsVisible="{Binding HasGrowthRatesData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasGrowthRatesData}">
                                            <TextBlock Text="No growth data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>
                    </Grid>
                </StackPanel>

                <!-- Customers Tab Content -->
                <StackPanel Margin="24" Spacing="24"
                            IsVisible="{Binding IsCustomersTabSelected}">
                    <!-- Stats Grid -->
                    <UniformGrid Columns="4" Rows="1">
                        <controls:StatCard Label="Total Customers"
                                           Value="1,234"
                                           Icon="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"
                                           IconColor="Primary"
                                           ChangeValue="8.5"
                                           ChangeText="+8.5%"
                                           Margin="0,0,12,0" />
                        <controls:StatCard Label="New Customers"
                                           Value="147"
                                           Icon="M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm-9-2V7H4v3H1v2h3v3h2v-3h3v-2H6zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"
                                           IconColor="Success"
                                           ChangeValue="23.1"
                                           ChangeText="+23.1%"
                                           Margin="0,0,12,0" />
                        <controls:StatCard Label="Retention Rate"
                                           Value="87.3%"
                                           Icon="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"
                                           IconColor="Info"
                                           ChangeValue="2.4"
                                           ChangeText="+2.4%"
                                           Margin="0,0,12,0" />
                        <controls:StatCard Label="Avg Customer Value"
                                           Value="$2,847"
                                           Icon="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1.41 16.09V20h-2.67v-1.93c-1.71-.36-3.16-1.46-3.27-3.4h1.96c.1 1.05.82 1.87 2.65 1.87 1.96 0 2.4-.98 2.4-1.59 0-.83-.44-1.61-2.67-2.14-2.48-.6-4.18-1.62-4.18-3.67 0-1.72 1.39-2.84 3.11-3.21V4h2.67v1.95c1.86.45 2.79 1.86 2.85 3.39H14.3c-.05-1.11-.64-1.87-2.22-1.87-1.5 0-2.4.68-2.4 1.64 0 .84.65 1.39 2.67 1.91s4.18 1.39 4.18 3.91c-.01 1.83-1.38 2.83-3.12 3.16z"
                                           IconColor="Warning"
                                           ChangeValue="11.2"
                                           ChangeText="+11.2%" />
                    </UniformGrid>

                    <!-- Charts Row 1 -->
                    <Grid ColumnDefinitions="*,*" Height="300">
                        <!-- Top Customers by Revenue -->
                        <Border Grid.Column="0"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="0,0,12,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Top Customers by Revenue"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Pie Chart - using Companies of Origin for top customers -->
                                        <lvc:PieChart Series="{Binding CompaniesOfOriginSeries}"
                                                      LegendPosition="Right"
                                                      LegendTextPaint="{Binding LegendTextPaint}"
                                                      IsVisible="{Binding HasCompaniesOfOriginData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasCompaniesOfOriginData}">
                                            <TextBlock Text="No customer data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>

                        <!-- Customer Payment Status -->
                        <Border Grid.Column="1"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="12,0,0,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Customer Payment Status"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <lvc:PieChart Series="{Binding CustomerPaymentStatusSeries}"
                                                      LegendPosition="Right"
                                                      LegendTextPaint="{Binding LegendTextPaint}"
                                                      IsVisible="{Binding HasCustomerPaymentStatusData}" />
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasCustomerPaymentStatusData}">
                                            <TextBlock Text="No payment data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>
                    </Grid>

                    <!-- Charts Row 2 -->
                    <Grid ColumnDefinitions="*,*" Height="300">
                        <!-- Customer Growth -->
                        <Border Grid.Column="0"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="0,0,12,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Customer Growth"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Chart - using Growth Rates -->
                                        <lvc:CartesianChart Series="{Binding GrowthRatesSeries}"
                                                            XAxes="{Binding GrowthRatesXAxes}"
                                                            YAxes="{Binding GrowthRatesYAxes}"
                                                            ZoomMode="X"
                                                            IsVisible="{Binding HasGrowthRatesData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasGrowthRatesData}">
                                            <TextBlock Text="No growth data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>

                        <!-- Customer Lifetime Value -->
                        <Border Grid.Column="1"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="12,0,0,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Customer Lifetime Value"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Chart - using Avg Transaction Value -->
                                        <lvc:CartesianChart Series="{Binding AvgTransactionValueSeries}"
                                                            XAxes="{Binding AvgTransactionValueXAxes}"
                                                            YAxes="{Binding AvgTransactionValueYAxes}"
                                                            ZoomMode="X"
                                                            IsVisible="{Binding HasAvgTransactionValueData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasAvgTransactionValueData}">
                                            <TextBlock Text="No value data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>
                    </Grid>

                    <!-- Charts Row 3 -->
                    <Grid ColumnDefinitions="*,*" Height="300">
                        <!-- Active vs Inactive Customers -->
                        <Border Grid.Column="0"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="0,0,12,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Active vs Inactive Customers"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <lvc:PieChart Series="{Binding ActiveInactiveCustomersSeries}"
                                                      LegendPosition="Right"
                                                      LegendTextPaint="{Binding LegendTextPaint}"
                                                      IsVisible="{Binding HasActiveInactiveCustomersData}" />
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasActiveInactiveCustomersData}">
                                            <TextBlock Text="No customer activity data"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>

                        <!-- Rentals per Customer -->
                        <Border Grid.Column="1"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="12,0,0,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Rentals per Customer"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Chart - using Total Transactions -->
                                        <lvc:CartesianChart Series="{Binding TotalTransactionsSeries}"
                                                            XAxes="{Binding TotalTransactionsXAxes}"
                                                            YAxes="{Binding TotalTransactionsYAxes}"
                                                            ZoomMode="X"
                                                            IsVisible="{Binding HasTotalTransactionsData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasTotalTransactionsData}">
                                            <TextBlock Text="No rental data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>
                    </Grid>
                </StackPanel>

                <!-- Returns Tab Content -->
                <StackPanel Margin="24" Spacing="24"
                            IsVisible="{Binding IsReturnsTabSelected}">
                    <!-- Stats Grid -->
                    <UniformGrid Columns="4" Rows="1">
                        <controls:StatCard Label="Total Returns"
                                           Value="89"
                                           Icon="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"
                                           IconColor="Warning"
                                           ChangeValue="-5.2"
                                           ChangeText="-5.2%"
                                           Margin="0,0,12,0" />
                        <controls:StatCard Label="Return Rate"
                                           Value="2.3%"
                                           Icon="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"
                                           IconColor="Info"
                                           ChangeValue="-0.3"
                                           ChangeText="-0.3%"
                                           Margin="0,0,12,0" />
                        <controls:StatCard Label="Financial Impact"
                                           Value="$4,521"
                                           Icon="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1.41 16.09V20h-2.67v-1.93c-1.71-.36-3.16-1.46-3.27-3.4h1.96c.1 1.05.82 1.87 2.65 1.87 1.96 0 2.4-.98 2.4-1.59 0-.83-.44-1.61-2.67-2.14-2.48-.6-4.18-1.62-4.18-3.67 0-1.72 1.39-2.84 3.11-3.21V4h2.67v1.95c1.86.45 2.79 1.86 2.85 3.39H14.3c-.05-1.11-.64-1.87-2.22-1.87-1.5 0-2.4.68-2.4 1.64 0 .84.65 1.39 2.67 1.91s4.18 1.39 4.18 3.91c-.01 1.83-1.38 2.83-3.12 3.16z"
                                           IconColor="Danger"
                                           ChangeValue="-8.7"
                                           ChangeText="-8.7%"
                                           Margin="0,0,12,0" />
                        <controls:StatCard Label="Avg Resolution Time"
                                           Value="1.8 days"
                                           Icon="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"
                                           IconColor="Success"
                                           ChangeValue="-15.3"
                                           ChangeText="-15.3%" />
                    </UniformGrid>

                    <!-- Charts Row 1 -->
                    <Grid ColumnDefinitions="*,*" Height="300">
                        <!-- Returns Over Time -->
                        <Border Grid.Column="0"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="0,0,12,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Returns Over Time"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Chart with data -->
                                        <lvc:CartesianChart Series="{Binding ReturnsOverTimeSeries}"
                                                            XAxes="{Binding ReturnsOverTimeXAxes}"
                                                            YAxes="{Binding ReturnsOverTimeYAxes}"
                                                            ZoomMode="X"
                                                            IsVisible="{Binding HasReturnsOverTimeData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasReturnsOverTimeData}">
                                            <TextBlock Text="No returns data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>

                        <!-- Return Reasons -->
                        <Border Grid.Column="1"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="12,0,0,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Return Reasons"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Pie Chart with data -->
                                        <lvc:PieChart Series="{Binding ReturnReasonsSeries}"
                                                      LegendPosition="Right"
                                                      LegendTextPaint="{Binding LegendTextPaint}"
                                                      IsVisible="{Binding HasReturnReasonsData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasReturnReasonsData}">
                                            <TextBlock Text="No return reasons data"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>
                    </Grid>

                    <!-- Charts Row 2 -->
                    <Grid ColumnDefinitions="*,*" Height="300">
                        <!-- Financial Impact of Returns -->
                        <Border Grid.Column="0"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="0,0,12,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Financial Impact of Returns"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Chart with data -->
                                        <lvc:CartesianChart Series="{Binding ReturnFinancialImpactSeries}"
                                                            XAxes="{Binding ReturnFinancialImpactXAxes}"
                                                            YAxes="{Binding ReturnFinancialImpactYAxes}"
                                                            ZoomMode="X"
                                                            IsVisible="{Binding HasReturnFinancialImpactData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasReturnFinancialImpactData}">
                                            <TextBlock Text="No financial impact data"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>

                        <!-- Returns by Category -->
                        <Border Grid.Column="1"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="12,0,0,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Returns by Category"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Pie Chart - reusing Return Reasons -->
                                        <lvc:PieChart Series="{Binding ReturnReasonsSeries}"
                                                      LegendPosition="Right"
                                                      LegendTextPaint="{Binding LegendTextPaint}"
                                                      IsVisible="{Binding HasReturnReasonsData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasReturnReasonsData}">
                                            <TextBlock Text="No category data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>
                    </Grid>

                    <!-- Charts Row 3 -->
                    <Grid ColumnDefinitions="*,*" Height="300">
                        <!-- Returns by Product -->
                        <Border Grid.Column="0"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="0,0,12,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Returns by Product"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Pie Chart - reusing Expense Distribution -->
                                        <lvc:PieChart Series="{Binding ExpensesDistributionSeries}"
                                                      LegendPosition="Right"
                                                      LegendTextPaint="{Binding LegendTextPaint}"
                                                      IsVisible="{Binding HasExpensesDistributionData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasExpensesDistributionData}">
                                            <TextBlock Text="No product data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>

                        <!-- Purchase vs Sale Returns -->
                        <Border Grid.Column="1"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="12,0,0,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Purchase vs Sale Returns"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Chart - using Sales vs Expenses -->
                                        <lvc:CartesianChart Series="{Binding SalesVsExpensesSeries}"
                                                            XAxes="{Binding SalesVsExpensesXAxes}"
                                                            YAxes="{Binding SalesVsExpensesYAxes}"
                                                            ZoomMode="X"
                                                            IsVisible="{Binding HasSalesVsExpensesData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasSalesVsExpensesData}">
                                            <TextBlock Text="No comparison data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>
                    </Grid>
                </StackPanel>

                <!-- Losses Tab Content -->
                <StackPanel Margin="24" Spacing="24"
                            IsVisible="{Binding IsLossesTabSelected}">
                    <!-- Stats Grid -->
                    <UniformGrid Columns="4" Rows="1">
                        <controls:StatCard Label="Total Losses"
                                           Value="34"
                                           Icon="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"
                                           IconColor="Danger"
                                           ChangeValue="-12.5"
                                           ChangeText="-12.5%"
                                           Margin="0,0,12,0" />
                        <controls:StatCard Label="Loss Rate"
                                           Value="0.9%"
                                           Icon="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"
                                           IconColor="Info"
                                           ChangeValue="-0.2"
                                           ChangeText="-0.2%"
                                           Margin="0,0,12,0" />
                        <controls:StatCard Label="Financial Impact"
                                           Value="$2,847"
                                           Icon="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1.41 16.09V20h-2.67v-1.93c-1.71-.36-3.16-1.46-3.27-3.4h1.96c.1 1.05.82 1.87 2.65 1.87 1.96 0 2.4-.98 2.4-1.59 0-.83-.44-1.61-2.67-2.14-2.48-.6-4.18-1.62-4.18-3.67 0-1.72 1.39-2.84 3.11-3.21V4h2.67v1.95c1.86.45 2.79 1.86 2.85 3.39H14.3c-.05-1.11-.64-1.87-2.22-1.87-1.5 0-2.4.68-2.4 1.64 0 .84.65 1.39 2.67 1.91s4.18 1.39 4.18 3.91c-.01 1.83-1.38 2.83-3.12 3.16z"
                                           IconColor="Warning"
                                           ChangeValue="-18.3"
                                           ChangeText="-18.3%"
                                           Margin="0,0,12,0" />
                        <controls:StatCard Label="Insurance Claims"
                                           Value="12"
                                           Icon="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-2 16l-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9l-8 8z"
                                           IconColor="Success"
                                           ChangeValue="2"
                                           ChangeText="+2" />
                    </UniformGrid>

                    <!-- Charts Row 1 -->
                    <Grid ColumnDefinitions="*,*" Height="300">
                        <!-- Losses Over Time -->
                        <Border Grid.Column="0"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="0,0,12,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Losses Over Time"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Chart with data -->
                                        <lvc:CartesianChart Series="{Binding LossesOverTimeSeries}"
                                                            XAxes="{Binding LossesOverTimeXAxes}"
                                                            YAxes="{Binding LossesOverTimeYAxes}"
                                                            ZoomMode="X"
                                                            IsVisible="{Binding HasLossesOverTimeData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasLossesOverTimeData}">
                                            <TextBlock Text="No losses data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>

                        <!-- Loss Reasons -->
                        <Border Grid.Column="1"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="12,0,0,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Loss Reasons"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Pie Chart - Loss Reasons -->
                                        <lvc:PieChart Series="{Binding LossReasonsSeries}"
                                                      LegendPosition="Right"
                                                      LegendTextPaint="{Binding LegendTextPaint}"
                                                      IsVisible="{Binding HasLossReasonsData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasLossReasonsData}">
                                            <TextBlock Text="No loss reasons data"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>
                    </Grid>

                    <!-- Charts Row 2 -->
                    <Grid ColumnDefinitions="*,*" Height="300">
                        <!-- Financial Impact of Losses -->
                        <Border Grid.Column="0"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="0,0,12,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Financial Impact of Losses"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Chart with data -->
                                        <lvc:CartesianChart Series="{Binding LossFinancialImpactSeries}"
                                                            XAxes="{Binding LossFinancialImpactXAxes}"
                                                            YAxes="{Binding LossFinancialImpactYAxes}"
                                                            ZoomMode="X"
                                                            IsVisible="{Binding HasLossFinancialImpactData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasLossFinancialImpactData}">
                                            <TextBlock Text="No financial impact data"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>

                        <!-- Losses by Category -->
                        <Border Grid.Column="1"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="12,0,0,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Losses by Category"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Pie Chart - reusing Expense Distribution -->
                                        <lvc:PieChart Series="{Binding ExpensesDistributionSeries}"
                                                      LegendPosition="Right"
                                                      LegendTextPaint="{Binding LegendTextPaint}"
                                                      IsVisible="{Binding HasExpensesDistributionData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasExpensesDistributionData}">
                                            <TextBlock Text="No category data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>
                    </Grid>

                    <!-- Charts Row 3 -->
                    <Grid ColumnDefinitions="*,*" Height="300">
                        <!-- Losses by Product -->
                        <Border Grid.Column="0"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="0,0,12,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Losses by Product"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Pie Chart - Losses by Product -->
                                        <lvc:PieChart Series="{Binding LossesByProductSeries}"
                                                      LegendPosition="Right"
                                                      LegendTextPaint="{Binding LegendTextPaint}"
                                                      IsVisible="{Binding HasLossesByProductData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasLossesByProductData}">
                                            <TextBlock Text="No product data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>

                        <!-- Purchase vs Sale Losses -->
                        <Border Grid.Column="1"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="12,0,0,0">
                            <Grid RowDefinitions="Auto,*">
                                <Border Grid.Row="0"
                                        Padding="20,16"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="0,0,0,1">
                                    <TextBlock Text="Purchase vs Sale Losses"
                                               FontSize="16"
                                               FontWeight="SemiBold"
                                               HorizontalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                </Border>
                                <Border Grid.Row="1" Padding="10">
                                    <Panel>
                                        <!-- Chart - using Sales vs Expenses -->
                                        <lvc:CartesianChart Series="{Binding SalesVsExpensesSeries}"
                                                            XAxes="{Binding SalesVsExpensesXAxes}"
                                                            YAxes="{Binding SalesVsExpensesYAxes}"
                                                            ZoomMode="X"
                                                            IsVisible="{Binding HasSalesVsExpensesData}" />
                                        <!-- No data placeholder -->
                                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                                CornerRadius="8"
                                                IsVisible="{Binding !HasSalesVsExpensesData}">
                                            <TextBlock Text="No comparison data available"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       FontSize="14"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </Border>
                                    </Panel>
                                </Border>
                            </Grid>
                        </Border>
                    </Grid>
                </StackPanel>
            </Panel>
        </ScrollViewer>
    </Grid>

    <UserControl.Styles>
        <!-- TabControl - page tabs styling -->
        <Style Selector="TabControl.page-tabs">
            <Setter Property="Background" Value="Transparent" />
        </Style>
        <Style Selector="TabControl.page-tabs /template/ ItemsPresenter#PART_ItemsPresenter">
            <Setter Property="Margin" Value="24,0" />
        </Style>
        <Style Selector="TabControl.page-tabs /template/ Border#PART_InnerBorder">
            <Setter Property="BorderThickness" Value="0" />
        </Style>
        <Style Selector="TabControl.page-tabs /template/ ContentPresenter#PART_SelectedContentHost">
            <Setter Property="IsVisible" Value="False" />
        </Style>

        <!-- Tab Item Styling -->
        <Style Selector="TabControl.page-tabs TabItem">
            <Setter Property="FontSize" Value="14" />
            <Setter Property="FontWeight" Value="Medium" />
            <Setter Property="Padding" Value="4,12,4,10" />
            <Setter Property="Margin" Value="8,0" />
            <Setter Property="Foreground" Value="{DynamicResource TextSecondaryBrush}" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Cursor" Value="Hand" />
        </Style>
        <Style Selector="TabControl.page-tabs TabItem:pointerover">
            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}" />
        </Style>
        <Style Selector="TabControl.page-tabs TabItem:pointerover /template/ ContentPresenter#PART_ContentPresenter">
            <Setter Property="TextBlock.Foreground" Value="{DynamicResource TextPrimaryBrush}" />
        </Style>
        <Style Selector="TabControl.page-tabs TabItem:selected">
            <Setter Property="Foreground" Value="{DynamicResource PrimaryBrush}" />
        </Style>
        <Style Selector="TabControl.page-tabs TabItem:selected /template/ ContentPresenter#PART_ContentPresenter">
            <Setter Property="TextBlock.Foreground" Value="{DynamicResource PrimaryBrush}" />
        </Style>
        <Style Selector="TabControl.page-tabs TabItem:selected /template/ Border#PART_SelectedPipe">
            <Setter Property="IsVisible" Value="True" />
            <Setter Property="Background" Value="{DynamicResource PrimaryBrush}" />
            <Setter Property="Height" Value="2" />
            <Setter Property="VerticalAlignment" Value="Bottom" />
            <Setter Property="Margin" Value="0,0,0,0" />
            <Setter Property="CornerRadius" Value="1" />
        </Style>

        <!-- Form ComboBox -->
        <Style Selector="ComboBox.form-combobox">
            <Setter Property="Background" Value="{DynamicResource SurfaceBrush}" />
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="6" />
            <Setter Property="Padding" Value="12,8" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="HorizontalAlignment" Value="Stretch" />
            <Setter Property="Cursor" Value="Hand" />
        </Style>

        <!-- Chart Toggle Switch -->
        <Style Selector="ToggleSwitch.chart-toggle">
            <Setter Property="Width" Value="44" />
            <Setter Property="Height" Value="24" />
            <Setter Property="Padding" Value="0" />
            <Setter Property="ClipToBounds" Value="False" />
        </Style>
        <Style Selector="ToggleSwitch.chart-toggle /template/ Grid">
            <Setter Property="ClipToBounds" Value="False" />
        </Style>
        <Style Selector="ToggleSwitch.chart-toggle /template/ Border#SwitchKnobBounds">
            <Setter Property="Background" Value="{DynamicResource SurfaceAltBrush}" />
            <Setter Property="CornerRadius" Value="12" />
        </Style>
        <Style Selector="ToggleSwitch.chart-toggle:checked /template/ Border#SwitchKnobBounds">
            <Setter Property="Background" Value="{DynamicResource PrimaryBrush}" />
        </Style>

        <!-- Segmented Button (RadioButton) -->
        <Style Selector="RadioButton.segmented-button">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Foreground" Value="{DynamicResource TextSecondaryBrush}" />
            <Setter Property="Padding" Value="12,6" />
            <Setter Property="CornerRadius" Value="4" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="FontWeight" Value="Medium" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <ControlTemplate>
                    <Border Background="{TemplateBinding Background}"
                            CornerRadius="{TemplateBinding CornerRadius}"
                            Padding="{TemplateBinding Padding}">
                        <ContentPresenter Content="{TemplateBinding Content}"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center" />
                    </Border>
                </ControlTemplate>
            </Setter>
        </Style>
        <Style Selector="RadioButton.segmented-button:pointerover">
            <Setter Property="Background" Value="{DynamicResource SurfaceBrush}" />
            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}" />
        </Style>
        <Style Selector="RadioButton.segmented-button:checked">
            <Setter Property="Background" Value="{DynamicResource SurfaceBrush}" />
            <Setter Property="Foreground" Value="{DynamicResource PrimaryBrush}" />
        </Style>
    </UserControl.Styles>
</UserControl>
