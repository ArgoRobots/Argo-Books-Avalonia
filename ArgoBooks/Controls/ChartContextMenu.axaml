<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:controls="using:ArgoBooks.Controls"
             xmlns:loc="using:ArgoBooks.Localization"
             xmlns:local="using:ArgoBooks"
             xmlns:icons="using:ArgoBooks"
             mc:Ignorable="d" d:DesignWidth="200" d:DesignHeight="200"
             x:Class="ArgoBooks.Controls.ChartContextMenu"
             x:DataType="controls:ChartContextMenu">

    <controls:AnimatedContextMenu IsOpen="{Binding IsOpen, RelativeSource={RelativeSource AncestorType=controls:ChartContextMenu}}"
                                   MenuX="{Binding MenuX, RelativeSource={RelativeSource AncestorType=controls:ChartContextMenu}}"
                                   MenuY="{Binding MenuY, RelativeSource={RelativeSource AncestorType=controls:ChartContextMenu}}"
                                   CloseCommand="{Binding CloseCommand, RelativeSource={RelativeSource AncestorType=controls:ChartContextMenu}}">
        <controls:AnimatedContextMenu.MenuContent>
            <StackPanel Spacing="2" MinWidth="200">
                <!-- Save as Image -->
                <Button Classes="context-menu-item"
                        Command="{Binding SaveChartAsImageCommand, RelativeSource={RelativeSource AncestorType=controls:ChartContextMenu}}">
                    <StackPanel Orientation="Horizontal" Spacing="10">
                        <PathIcon Data="{x:Static icons:Icons.Image}"
                                  Width="16" Height="16"
                                  Foreground="{DynamicResource TextSecondaryBrush}" />
                        <TextBlock Text="{loc:Loc 'Save as Image'}"
                                   FontSize="13"
                                   Foreground="{DynamicResource TextPrimaryBrush}" />
                    </StackPanel>
                </Button>

                <!-- Export Options (hidden for geomaps) -->
                <StackPanel Spacing="2"
                            IsVisible="{Binding ShowExportOptions, RelativeSource={RelativeSource AncestorType=controls:ChartContextMenu}}">
                    <!-- Separator -->
                    <Border Height="1"
                            Background="{DynamicResource BorderBrush}"
                            Margin="4,4" />

                    <!-- Export to Google Sheets -->
                    <Button Classes="context-menu-item"
                            Command="{Binding ExportToGoogleSheetsCommand, RelativeSource={RelativeSource AncestorType=controls:ChartContextMenu}}">
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <PathIcon Data="{x:Static icons:Icons.CloudUpload}"
                                      Width="16" Height="16"
                                      Foreground="{DynamicResource TextSecondaryBrush}" />
                            <TextBlock Text="{loc:Loc 'Export to Google Sheets'}"
                                       FontSize="13"
                                       Foreground="{DynamicResource TextPrimaryBrush}" />
                        </StackPanel>
                    </Button>

                    <!-- Export to Excel -->
                    <Button Classes="context-menu-item"
                            Command="{Binding ExportToExcelCommand, RelativeSource={RelativeSource AncestorType=controls:ChartContextMenu}}">
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <PathIcon Data="{x:Static local:Icons.Reports}"
                                      Width="16" Height="16"
                                      Foreground="{DynamicResource TextSecondaryBrush}" />
                            <TextBlock Text="{loc:Loc 'Export to Excel'}"
                                       FontSize="13"
                                       Foreground="{DynamicResource TextPrimaryBrush}" />
                        </StackPanel>
                    </Button>
                </StackPanel>

                <!-- Reset Zoom (hidden for pie charts and geomaps) -->
                <StackPanel Spacing="2"
                            IsVisible="{Binding ShowResetZoom, RelativeSource={RelativeSource AncestorType=controls:ChartContextMenu}}">
                    <!-- Separator -->
                    <Border Height="1"
                            Background="{DynamicResource BorderBrush}"
                            Margin="4,4" />

                    <!-- Reset Zoom -->
                    <Button Classes="context-menu-item"
                            Command="{Binding ResetChartZoomCommand, RelativeSource={RelativeSource AncestorType=controls:ChartContextMenu}}">
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <PathIcon Data="{x:Static local:Icons.Undo}"
                                      Width="16" Height="16"
                                      Foreground="{DynamicResource TextSecondaryBrush}" />
                            <TextBlock Text="{loc:Loc 'Reset Zoom'}"
                                       FontSize="13"
                                       Foreground="{DynamicResource TextPrimaryBrush}" />
                        </StackPanel>
                    </Button>
                </StackPanel>
            </StackPanel>
        </controls:AnimatedContextMenu.MenuContent>
    </controls:AnimatedContextMenu>
</UserControl>
