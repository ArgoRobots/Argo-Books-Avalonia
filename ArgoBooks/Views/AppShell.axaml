<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:ArgoBooks.ViewModels"
             xmlns:controls="using:ArgoBooks.Controls"
             mc:Ignorable="d" d:DesignWidth="1280" d:DesignHeight="800"
             x:Class="ArgoBooks.Views.AppShell"
             x:DataType="vm:AppShellViewModel"
             Background="{DynamicResource BackgroundBrush}">

    <Design.DataContext>
        <vm:AppShellViewModel />
    </Design.DataContext>

    <Grid ColumnDefinitions="Auto,*">
        <!-- Sidebar -->
        <controls:Sidebar Grid.Column="0"
                          DataContext="{Binding SidebarViewModel}"
                          Width="{Binding Width}" />

        <!-- Main Content Area -->
        <Grid Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <!-- Header -->
            <Border Grid.Row="0"
                    Background="{DynamicResource HeaderBackgroundBrush}"
                    BorderBrush="{DynamicResource HeaderBorderBrush}"
                    BorderThickness="0,0,0,1"
                    Padding="24,12">
                <Grid ColumnDefinitions="*,Auto,Auto,Auto,Auto">
                    <!-- Global Search -->
                    <Border Grid.Column="0"
                            Background="{DynamicResource InputBackgroundBrush}"
                            BorderBrush="{DynamicResource InputBorderBrush}"
                            BorderThickness="1"
                            CornerRadius="{StaticResource RadiusMd}"
                            MaxWidth="400"
                            HorizontalAlignment="Left">
                        <Grid ColumnDefinitions="Auto,*">
                            <PathIcon Grid.Column="0"
                                      Data="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
                                      Width="16" Height="16"
                                      Foreground="{DynamicResource TextTertiaryBrush}"
                                      Margin="12,0,8,0" />
                            <TextBox Grid.Column="1"
                                     Watermark="Search..."
                                     BorderThickness="0"
                                     Background="Transparent"
                                     Padding="0,8,12,8"
                                     Text="{Binding SearchQuery}" />
                        </Grid>
                    </Border>

                    <!-- Quick Actions -->
                    <Button Grid.Column="1"
                            Classes="icon"
                            Width="36" Height="36"
                            Margin="8,0"
                            Command="{Binding OpenQuickActionsCommand}"
                            ToolTip.Tip="Quick Actions (Ctrl+K)">
                        <PathIcon Data="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"
                                  Width="20" Height="20"
                                  Foreground="{DynamicResource TextSecondaryBrush}" />
                    </Button>

                    <!-- Notifications -->
                    <Button Grid.Column="2"
                            Classes="icon"
                            Width="36" Height="36"
                            Margin="8,0"
                            Command="{Binding OpenNotificationsCommand}"
                            ToolTip.Tip="Notifications">
                        <Panel>
                            <PathIcon Data="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"
                                      Width="20" Height="20"
                                      Foreground="{DynamicResource TextSecondaryBrush}" />
                            <!-- Notification Badge -->
                            <Border Background="{DynamicResource DangerBrush}"
                                    Width="8" Height="8"
                                    CornerRadius="4"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Top"
                                    Margin="0,4,4,0"
                                    IsVisible="{Binding HasUnreadNotifications}" />
                        </Panel>
                    </Button>

                    <!-- User Menu -->
                    <Button Grid.Column="3"
                            Classes="icon"
                            Width="36" Height="36"
                            Margin="8,0,0,0"
                            Command="{Binding OpenUserMenuCommand}"
                            ToolTip.Tip="User Menu">
                        <PathIcon Data="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"
                                  Width="20" Height="20"
                                  Foreground="{DynamicResource TextSecondaryBrush}" />
                    </Button>
                </Grid>
            </Border>

            <!-- Page Content -->
            <Border Grid.Row="1"
                    Background="{DynamicResource BackgroundSecondaryBrush}">
                <ContentControl Content="{Binding CurrentPage}"
                                Margin="24" />
            </Border>
        </Grid>
    </Grid>
</UserControl>
