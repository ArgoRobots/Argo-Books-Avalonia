<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:ArgoBooks.ViewModels"
             xmlns:loc="using:ArgoBooks.Localization"
             xmlns:controls="using:ArgoBooks.Controls"
             xmlns:local="using:ArgoBooks"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="600"
             x:Class="ArgoBooks.Modals.ReturnsModals"
             x:DataType="vm:ReturnsModalsViewModel">

    <Panel>
        <!-- Filter Modal -->
        <controls:ModalOverlay IsOpen="{Binding IsFilterModalOpen}"
                               ClosingCommand="{Binding RequestCloseFilterModalCommand}">
            <controls:ModalOverlay.ModalContent>
                <Border HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Width="480"
                        MaxHeight="520"
                        Background="{DynamicResource SurfaceBrush}"
                        CornerRadius="12"
                        BoxShadow="0 8 32 0 #40000000">
                <Grid RowDefinitions="Auto,*,Auto">
                    <!-- Modal Header -->
                    <Border Grid.Row="0"
                            Padding="24,16"
                            BorderBrush="{DynamicResource BorderBrush}"
                            BorderThickness="0,0,0,1">
                        <Grid ColumnDefinitions="*,Auto">
                            <TextBlock Text="{loc:Loc 'Filter Returns'}"
                                       FontSize="18"
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource TextPrimaryBrush}" />
                            <Button Grid.Column="1"
                                    Classes="icon-button"
                                    Command="{Binding CloseFilterModalCommand}">
                                <PathIcon Data="{x:Static local:Icons.Close}"
                                          Width="20" Height="20" />
                            </Button>
                        </Grid>
                    </Border>

                    <!-- Modal Content -->
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <StackPanel Margin="24" Spacing="16">
                            <!-- From Date -->
                            <StackPanel Spacing="8">
                                <TextBlock Text="{loc:Loc 'From Date'}"
                                           FontSize="13"
                                           FontWeight="Medium"
                                           Foreground="{DynamicResource TextSecondaryBrush}" />
                                <DatePicker SelectedDate="{Binding FilterDateFrom}"
                                            Classes="form-datepicker"
                                            HorizontalAlignment="Stretch" />
                            </StackPanel>

                            <!-- To Date -->
                            <StackPanel Spacing="8">
                                <TextBlock Text="{loc:Loc 'To Date'}"
                                           FontSize="13"
                                           FontWeight="Medium"
                                           Foreground="{DynamicResource TextSecondaryBrush}" />
                                <DatePicker SelectedDate="{Binding FilterDateTo}"
                                            Classes="form-datepicker"
                                            HorizontalAlignment="Stretch" />
                            </StackPanel>

                            <!-- Reason -->
                            <StackPanel Spacing="8">
                                <TextBlock Text="{loc:Loc Reason}"
                                           FontSize="13"
                                           FontWeight="Medium"
                                           Foreground="{DynamicResource TextSecondaryBrush}" />
                                <ComboBox ItemsSource="{Binding ReasonOptions}"
                                          SelectedItem="{Binding FilterReason}"
                                          HorizontalAlignment="Stretch">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Converter={StaticResource TranslateConverter}}" />
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                            </StackPanel>
                        </StackPanel>
                    </ScrollViewer>

                    <!-- Modal Footer -->
                    <Border Grid.Row="2"
                            Padding="24,16"
                            BorderBrush="{DynamicResource BorderBrush}"
                            BorderThickness="0,1,0,0">
                        <Grid ColumnDefinitions="*,Auto,Auto">
                            <Button Grid.Column="0"
                                    Content="{loc:Loc 'Clear Filters'}"
                                    Classes="secondary-button"
                                    HorizontalAlignment="Left"
                                    Command="{Binding ClearFiltersCommand}" />
                            <Button Grid.Column="1"
                                    Content="{loc:Loc Cancel}"
                                    Classes="secondary-button"
                                    Margin="0,0,12,0"
                                    Command="{Binding CloseFilterModalCommand}" />
                            <Button Grid.Column="2"
                                    Content="{loc:Loc 'Apply Filters'}"
                                    Classes="primary-button"
                                    Command="{Binding ApplyFiltersCommand}" />
                        </Grid>
                    </Border>
                </Grid>
                </Border>
            </controls:ModalOverlay.ModalContent>
        </controls:ModalOverlay>

        <!-- View Details Modal -->
        <controls:ModalOverlay IsOpen="{Binding IsViewDetailsModalOpen}"
                               ClosingCommand="{Binding CloseViewDetailsModalCommand}">
            <controls:ModalOverlay.ModalContent>
                <Border Background="{DynamicResource SurfaceBrush}"
                        CornerRadius="12"
                        Width="500"
                        MaxHeight="600"
                        ClipToBounds="True"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        BoxShadow="0 8 32 0 #40000000">
                    <Grid RowDefinitions="Auto,*,Auto">
                        <!-- Modal Header -->
                        <Border Grid.Row="0"
                                Padding="24,20"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="0,0,0,1">
                            <Grid ColumnDefinitions="*,Auto">
                                <StackPanel Orientation="Horizontal" Spacing="12">
                                    <Border Width="40" Height="40"
                                            CornerRadius="8"
                                            Background="{DynamicResource PrimaryLightBrush}">
                                        <PathIcon Data="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"
                                                  Width="20" Height="20"
                                                  Foreground="{DynamicResource PrimaryBrush}" />
                                    </Border>
                                    <StackPanel VerticalAlignment="Center">
                                        <TextBlock Text="{loc:Loc 'Return Details'}"
                                                   FontSize="18"
                                                   FontWeight="SemiBold"
                                                   Foreground="{DynamicResource TextPrimaryBrush}" />
                                        <TextBlock Text="{Binding ViewDetailsId}"
                                                   FontSize="12"
                                                   Foreground="{DynamicResource TextTertiaryBrush}" />
                                    </StackPanel>
                                </StackPanel>
                                <Button Grid.Column="1"
                                        Classes="icon-button"
                                        Command="{Binding CloseViewDetailsModalCommand}">
                                    <PathIcon Data="{x:Static local:Icons.Close}"
                                              Width="20" Height="20" />
                                </Button>
                            </Grid>
                        </Border>

                        <!-- Modal Content -->
                        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                            <StackPanel Margin="24" Spacing="20">
                                <!-- Product -->
                                <StackPanel Spacing="6">
                                    <TextBlock Text="{loc:Loc 'Product'}"
                                               FontSize="12"
                                               FontWeight="Medium"
                                               Foreground="{DynamicResource TextTertiaryBrush}" />
                                    <TextBlock Text="{Binding ViewDetailsProduct}"
                                               FontSize="14"
                                               Foreground="{DynamicResource TextPrimaryBrush}"
                                               TextWrapping="Wrap" />
                                </StackPanel>

                                <!-- Date and Refund -->
                                <Grid ColumnDefinitions="*,*">
                                    <StackPanel Grid.Column="0" Spacing="6">
                                        <TextBlock Text="{loc:Loc 'Return Date'}"
                                                   FontSize="12"
                                                   FontWeight="Medium"
                                                   Foreground="{DynamicResource TextTertiaryBrush}" />
                                        <TextBlock Text="{Binding ViewDetailsDate}"
                                                   FontSize="14"
                                                   Foreground="{DynamicResource TextPrimaryBrush}" />
                                    </StackPanel>
                                    <StackPanel Grid.Column="1" Spacing="6">
                                        <TextBlock Text="{loc:Loc 'Refund Amount'}"
                                                   FontSize="12"
                                                   FontWeight="Medium"
                                                   Foreground="{DynamicResource TextTertiaryBrush}" />
                                        <TextBlock Text="{Binding ViewDetailsRefund}"
                                                   FontSize="14"
                                                   FontWeight="SemiBold"
                                                   Foreground="{DynamicResource TextPrimaryBrush}" />
                                    </StackPanel>
                                </Grid>

                                <!-- Reason -->
                                <StackPanel Spacing="6">
                                    <TextBlock Text="{loc:Loc 'Reason'}"
                                               FontSize="12"
                                               FontWeight="Medium"
                                               Foreground="{DynamicResource TextTertiaryBrush}" />
                                    <Border Background="{DynamicResource SurfaceAltBrush}"
                                            CornerRadius="8"
                                            Padding="12">
                                        <TextBlock Text="{Binding ViewDetailsReason}"
                                                   FontSize="14"
                                                   Foreground="{DynamicResource TextPrimaryBrush}"
                                                   TextWrapping="Wrap" />
                                    </Border>
                                </StackPanel>

                                <!-- Notes -->
                                <StackPanel Spacing="6">
                                    <TextBlock Text="{loc:Loc 'Notes'}"
                                               FontSize="12"
                                               FontWeight="Medium"
                                               Foreground="{DynamicResource TextTertiaryBrush}" />
                                    <Border Background="{DynamicResource SurfaceAltBrush}"
                                            CornerRadius="8"
                                            Padding="12"
                                            MinHeight="60">
                                        <TextBlock Text="{Binding ViewDetailsNotes}"
                                                   FontSize="14"
                                                   Foreground="{DynamicResource TextPrimaryBrush}"
                                                   TextWrapping="Wrap" />
                                    </Border>
                                </StackPanel>
                            </StackPanel>
                        </ScrollViewer>

                        <!-- Modal Footer -->
                        <Border Grid.Row="2"
                                Padding="24,16"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="0,1,0,0">
                            <Button Content="{loc:Loc 'Close'}"
                                    Classes="secondary-button"
                                    HorizontalAlignment="Right"
                                    Command="{Binding CloseViewDetailsModalCommand}" />
                        </Border>
                    </Grid>
                </Border>
            </controls:ModalOverlay.ModalContent>
        </controls:ModalOverlay>

        <!-- Undo Return Modal -->
        <controls:ModalOverlay IsOpen="{Binding IsUndoReturnModalOpen}"
                               ClosingCommand="{Binding CloseUndoReturnModalCommand}">
            <controls:ModalOverlay.ModalContent>
                <Border Background="{DynamicResource SurfaceBrush}"
                        CornerRadius="12"
                        Width="450"
                        MaxHeight="500"
                        ClipToBounds="True"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        BoxShadow="0 8 32 0 #40000000">
                    <Grid RowDefinitions="Auto,*,Auto">
                        <!-- Modal Header -->
                        <Border Grid.Row="0"
                                Padding="24,20"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="0,0,0,1">
                            <Grid ColumnDefinitions="*,Auto">
                                <StackPanel Orientation="Horizontal" Spacing="12">
                                    <Border Width="40" Height="40"
                                            CornerRadius="8"
                                            Background="{DynamicResource WarningLightBrush}">
                                        <PathIcon Data="{x:Static local:Icons.Returns}"
                                                  Width="20" Height="20"
                                                  Foreground="#D97706" />
                                    </Border>
                                    <TextBlock Text="{loc:Loc 'Undo Return'}"
                                               FontSize="18"
                                               FontWeight="SemiBold"
                                               Foreground="{DynamicResource TextPrimaryBrush}"
                                               VerticalAlignment="Center" />
                                </StackPanel>
                                <Button Grid.Column="1"
                                        Classes="icon-button"
                                        Command="{Binding CloseUndoReturnModalCommand}">
                                    <PathIcon Data="{x:Static local:Icons.Close}"
                                              Width="20" Height="20" />
                                </Button>
                            </Grid>
                        </Border>

                        <!-- Modal Content -->
                        <StackPanel Grid.Row="1" Spacing="16" Margin="24">
                            <!-- Item Description -->
                            <StackPanel Spacing="6">
                                <TextBlock Text="{loc:Loc 'Return to undo:'}"
                                           FontSize="13"
                                           FontWeight="Medium"
                                           Foreground="{DynamicResource TextPrimaryBrush}" />
                                <TextBlock Text="{Binding UndoReturnItemDescription}"
                                           FontSize="14"
                                           FontWeight="Medium"
                                           Foreground="{DynamicResource TextPrimaryBrush}" />
                            </StackPanel>

                            <!-- Reason (Optional) -->
                            <StackPanel Spacing="8">
                                <TextBlock FontSize="13"
                                           FontWeight="Medium"
                                           Foreground="{DynamicResource TextPrimaryBrush}">
                                    <Run Text="{loc:Loc 'Reason for undo'}" />
                                    <Run Text="{loc:Loc '(optional)'}" Foreground="{DynamicResource TextTertiaryBrush}" />
                                </TextBlock>
                                <TextBox Text="{Binding UndoReturnReason, Mode=TwoWay}"
                                         Watermark="{loc:Loc 'Enter reason for undoing this return...'}"
                                         AcceptsReturn="True"
                                         TextWrapping="Wrap"
                                         MinHeight="80"
                                         MaxHeight="120" />
                            </StackPanel>
                        </StackPanel>

                        <!-- Modal Footer -->
                        <Border Grid.Row="2"
                                Padding="24,16"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="0,1,0,0">
                            <Grid ColumnDefinitions="*,Auto,Auto">
                                <Button Grid.Column="1"
                                        Content="{loc:Loc 'Cancel'}"
                                        Classes="secondary-button"
                                        Margin="0,0,12,0"
                                        Command="{Binding CloseUndoReturnModalCommand}" />
                                <Button Grid.Column="2"
                                        Content="{loc:Loc 'Undo Return'}"
                                        Classes="danger-button"
                                        Command="{Binding ConfirmUndoReturnCommand}" />
                            </Grid>
                        </Border>
                    </Grid>
                </Border>
            </controls:ModalOverlay.ModalContent>
        </controls:ModalOverlay>
    </Panel>
</UserControl>
