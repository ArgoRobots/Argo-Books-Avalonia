<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:controls="using:ArgoBooks.Controls"
             mc:Ignorable="d" d:DesignWidth="500" d:DesignHeight="400"
             x:Class="ArgoBooks.Controls.ModalContainer"
             x:DataType="controls:ModalContainer">

    <Border Background="{DynamicResource SurfaceBrush}"
            BorderBrush="{DynamicResource BorderBrush}"
            BorderThickness="1"
            CornerRadius="{StaticResource RadiusLg}"
            BoxShadow="0 8 24 0 #40000000"
            MinWidth="{Binding MinWidth, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}}"
            MaxWidth="{Binding MaxWidth, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}}"
            MinHeight="{Binding MinHeight, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}}"
            MaxHeight="{Binding MaxHeight, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}}"
            Width="{Binding ModalWidth, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}}"
            Classes.sm="{Binding Size, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}, Converter={x:Static ObjectConverters.Equal}, ConverterParameter={x:Static controls:ModalSize.Small}}"
            Classes.md="{Binding Size, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}, Converter={x:Static ObjectConverters.Equal}, ConverterParameter={x:Static controls:ModalSize.Medium}}"
            Classes.lg="{Binding Size, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}, Converter={x:Static ObjectConverters.Equal}, ConverterParameter={x:Static controls:ModalSize.Large}}"
            Classes.xl="{Binding Size, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}, Converter={x:Static ObjectConverters.Equal}, ConverterParameter={x:Static controls:ModalSize.ExtraLarge}}"
            Classes.full="{Binding Size, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}, Converter={x:Static ObjectConverters.Equal}, ConverterParameter={x:Static controls:ModalSize.Full}}">
        <Border.Styles>
            <Style Selector="Border.sm">
                <Setter Property="Width" Value="400" />
            </Style>
            <Style Selector="Border.md">
                <Setter Property="Width" Value="500" />
            </Style>
            <Style Selector="Border.lg">
                <Setter Property="Width" Value="700" />
            </Style>
            <Style Selector="Border.xl">
                <Setter Property="Width" Value="900" />
            </Style>
            <Style Selector="Border.full">
                <Setter Property="Width" Value="NaN" />
                <Setter Property="Margin" Value="32" />
            </Style>
        </Border.Styles>

        <DockPanel>
            <!-- Header -->
            <Border DockPanel.Dock="Top"
                    Padding="24,20"
                    BorderBrush="{DynamicResource BorderLightBrush}"
                    BorderThickness="0,0,0,1"
                    IsVisible="{Binding ShowHeader, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}}">
                <Grid ColumnDefinitions="*,Auto">
                    <StackPanel Grid.Column="0" Spacing="4">
                        <!-- Title -->
                        <TextBlock Text="{Binding Title, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}}"
                                   FontSize="{StaticResource FontSizeXl}"
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource TextPrimaryBrush}"
                                   IsVisible="{Binding Title, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}, Converter={x:Static StringConverters.IsNotNullOrEmpty}}" />

                        <!-- Subtitle -->
                        <TextBlock Text="{Binding Subtitle, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}}"
                                   FontSize="{StaticResource FontSizeSm}"
                                   Foreground="{DynamicResource TextSecondaryBrush}"
                                   IsVisible="{Binding Subtitle, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}, Converter={x:Static StringConverters.IsNotNullOrEmpty}}" />
                    </StackPanel>

                    <!-- Close Button -->
                    <Button Grid.Column="1"
                            Classes="icon"
                            Width="32" Height="32"
                            VerticalAlignment="Top"
                            IsVisible="{Binding ShowCloseButton, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}}"
                            Command="{Binding CloseCommand, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}}"
                            ToolTip.Tip="Close">
                        <PathIcon Data="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"
                                  Width="18" Height="18"
                                  Foreground="{DynamicResource TextTertiaryBrush}" />
                    </Button>
                </Grid>
            </Border>

            <!-- Footer -->
            <Border DockPanel.Dock="Bottom"
                    Padding="24,16"
                    BorderBrush="{DynamicResource BorderLightBrush}"
                    BorderThickness="0,1,0,0"
                    IsVisible="{Binding ShowFooter, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}}">
                <Grid ColumnDefinitions="*,Auto">
                    <!-- Left Footer Content -->
                    <ContentPresenter Grid.Column="0"
                                      Content="{Binding FooterLeftContent, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}}"
                                      VerticalAlignment="Center" />

                    <!-- Footer Buttons -->
                    <StackPanel Grid.Column="1"
                                Orientation="Horizontal"
                                Spacing="12"
                                HorizontalAlignment="Right">
                        <!-- Secondary Action -->
                        <Button Classes="secondary"
                                Content="{Binding SecondaryButtonText, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}}"
                                Command="{Binding SecondaryCommand, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}}"
                                IsVisible="{Binding SecondaryButtonText, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}, Converter={x:Static StringConverters.IsNotNullOrEmpty}}" />

                        <!-- Primary Action -->
                        <controls:ArgoButton Text="{Binding PrimaryButtonText, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}}"
                                             Variant="Primary"
                                             Command="{Binding PrimaryCommand, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}}"
                                             IsLoading="{Binding IsPrimaryLoading, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}}"
                                             IsVisible="{Binding PrimaryButtonText, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}, Converter={x:Static StringConverters.IsNotNullOrEmpty}}" />
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Content -->
            <ScrollViewer HorizontalScrollBarVisibility="Disabled"
                          VerticalScrollBarVisibility="Auto"
                          Padding="24,20">
                <ContentPresenter Content="{Binding ModalContent, RelativeSource={RelativeSource AncestorType=controls:ModalContainer}}" />
            </ScrollViewer>
        </DockPanel>
    </Border>
</UserControl>
