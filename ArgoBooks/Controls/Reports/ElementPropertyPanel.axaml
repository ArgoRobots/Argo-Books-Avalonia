<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:loc="using:ArgoBooks.Localization"
             xmlns:icons="using:ArgoBooks"
             mc:Ignorable="d" d:DesignWidth="280" d:DesignHeight="600"
             x:Class="ArgoBooks.Controls.Reports.ElementPropertyPanel"
             x:Name="PropertyPanel"
             Background="#FAFAFA">

    <UserControl.Styles>
        <!-- Section header style -->
        <Style Selector="TextBlock.section-header">
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="#424242"/>
            <Setter Property="Margin" Value="0,12,0,8"/>
        </Style>

        <!-- Property label style -->
        <Style Selector="TextBlock.property-label">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="#616161"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <!-- Input field style -->
        <Style Selector="TextBox.property-input">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="CornerRadius" Value="4"/>
        </Style>

        <!-- NumericUpDown style -->
        <Style Selector="NumericUpDown.property-input">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Padding" Value="8,6"/>
        </Style>

        <!-- ComboBox style -->
        <Style Selector="ComboBox.property-input">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="CornerRadius" Value="4"/>
        </Style>

        <!-- Checkbox style -->
        <Style Selector="CheckBox.property-checkbox">
            <Setter Property="FontSize" Value="12"/>
        </Style>

        <!-- Separator style -->
        <Style Selector="Border.property-separator">
            <Setter Property="Height" Value="1"/>
            <Setter Property="Background" Value="#E0E0E0"/>
            <Setter Property="Margin" Value="0,12,0,0"/>
        </Style>

        <!-- Color button style -->
        <Style Selector="Button.color-button">
            <Setter Property="Width" Value="32"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Padding" Value="2"/>
            <Setter Property="CornerRadius" Value="4"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#BDBDBD"/>
        </Style>
    </UserControl.Styles>

    <ScrollViewer VerticalScrollBarVisibility="Auto"
                  HorizontalScrollBarVisibility="Disabled">
        <StackPanel Margin="12">

            <!-- No Selection Message -->
            <TextBlock x:Name="NoSelectionMessage"
                       Text="{loc:Loc 'No element selected'}"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"
                       Foreground="#9E9E9E"
                       FontStyle="Italic"
                       Margin="0,40,0,0"
                       IsVisible="{Binding !HasSelection, ElementName=PropertyPanel}"/>

            <!-- Multi-Selection Message -->
            <StackPanel x:Name="MultiSelectionPanel"
                        IsVisible="{Binding HasMultiSelection, ElementName=PropertyPanel}">
                <TextBlock Text="{loc:Loc 'Multiple Elements Selected'}"
                           Classes="section-header"
                           HorizontalAlignment="Center"/>
                <TextBlock x:Name="SelectionCountText"
                           HorizontalAlignment="Center"
                           Foreground="#757575"
                           FontSize="12"
                           Margin="0,4,0,0"/>
            </StackPanel>

            <!-- Single Element Properties -->
            <StackPanel x:Name="SingleElementPanel"
                        IsVisible="{Binding HasSingleSelection, ElementName=PropertyPanel}">

                <!-- Element Type Header -->
                <Border Background="#E3F2FD"
                        CornerRadius="4"
                        Padding="12,8"
                        Margin="0,0,0,12">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <PathIcon x:Name="ElementTypeIcon" Width="20" Height="20" Foreground="#1976D2"/>
                        <TextBlock x:Name="ElementTypeText"
                                   FontWeight="SemiBold"
                                   FontSize="14"
                                   Foreground="#1976D2"
                                   VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>

                <!-- Common Properties Section -->
                <TextBlock Text="{loc:Loc 'Position &amp; Size'}" Classes="section-header"/>

                <Grid ColumnDefinitions="*,8,*" RowDefinitions="Auto,8,Auto">
                    <!-- X Position -->
                    <StackPanel Grid.Row="0" Grid.Column="0">
                        <TextBlock Text="{loc:Loc X}" Classes="property-label"/>
                        <NumericUpDown x:Name="PositionX"
                                       Classes="property-input"
                                       Minimum="0"
                                       FormatString="F0"
                                       ValueChanged="OnPositionXChanged"/>
                    </StackPanel>

                    <!-- Y Position -->
                    <StackPanel Grid.Row="0" Grid.Column="2">
                        <TextBlock Text="{loc:Loc Y}" Classes="property-label"/>
                        <NumericUpDown x:Name="PositionY"
                                       Classes="property-input"
                                       Minimum="0"
                                       FormatString="F0"
                                       ValueChanged="OnPositionYChanged"/>
                    </StackPanel>

                    <!-- Width -->
                    <StackPanel Grid.Row="2" Grid.Column="0">
                        <TextBlock Text="{loc:Loc Width}" Classes="property-label"/>
                        <NumericUpDown x:Name="ElementWidth"
                                       Classes="property-input"
                                       Minimum="20"
                                       FormatString="F0"
                                       ValueChanged="OnWidthChanged"/>
                    </StackPanel>

                    <!-- Height -->
                    <StackPanel Grid.Row="2" Grid.Column="2">
                        <TextBlock Text="{loc:Loc Height}" Classes="property-label"/>
                        <NumericUpDown x:Name="ElementHeight"
                                       Classes="property-input"
                                       Minimum="20"
                                       FormatString="F0"
                                       ValueChanged="OnHeightChanged"/>
                    </StackPanel>
                </Grid>

                <Border Classes="property-separator"/>

                <!-- Lock/Visibility Properties -->
                <TextBlock Text="{loc:Loc Display}" Classes="section-header"/>

                <StackPanel Spacing="8">
                    <ToggleSwitch x:Name="IsLockedToggle"
                                  OnContent="{loc:Loc 'Lock element'}"
                                  OffContent="{loc:Loc 'Lock element'}"
                                  IsCheckedChanged="OnIsLockedChanged"/>
                    <ToggleSwitch x:Name="IsVisibleToggle"
                                  OnContent="{loc:Loc Visible}"
                                  OffContent="{loc:Loc Visible}"
                                  IsCheckedChanged="OnIsVisibleChanged"/>
                </StackPanel>

                <Border Classes="property-separator"/>

                <!-- Z-Order Section -->
                <TextBlock Text="{loc:Loc 'Layer Order'}" Classes="section-header"/>

                <StackPanel Orientation="Horizontal" Spacing="8">
                    <Button x:Name="BringToFrontButton"
                            ToolTip.Tip="{loc:Loc 'Bring to Front'}"
                            Click="OnBringToFrontClick"
                            Padding="8,6">
                        <PathIcon Width="16" Height="16"
                                  Data="{x:Static icons:Icons.QrCode}"/>
                    </Button>
                    <Button x:Name="SendToBackButton"
                            ToolTip.Tip="{loc:Loc 'Send to Back'}"
                            Click="OnSendToBackClick"
                            Padding="8,6">
                        <PathIcon Width="16" Height="16"
                                  Data="{x:Static icons:Icons.Layers}"/>
                    </Button>
                    <Button x:Name="BringForwardButton"
                            ToolTip.Tip="{loc:Loc 'Bring Forward'}"
                            Click="OnBringForwardClick"
                            Padding="8,6">
                        <PathIcon Width="16" Height="16"
                                  Data="{x:Static icons:Icons.Square}"/>
                    </Button>
                    <Button x:Name="SendBackwardButton"
                            ToolTip.Tip="{loc:Loc 'Send Backward'}"
                            Click="OnSendBackwardClick"
                            Padding="8,6">
                        <PathIcon Width="16" Height="16"
                                  Data="{x:Static icons:Icons.LayersAlt}"/>
                    </Button>
                </StackPanel>

                <Border Classes="property-separator"/>

                <!-- Element-Specific Properties Container -->
                <ContentControl x:Name="ElementSpecificProperties"/>
            </StackPanel>
        </StackPanel>
    </ScrollViewer>
</UserControl>
