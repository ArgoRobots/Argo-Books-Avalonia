<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:controls="using:ArgoBooks.Controls"
             xmlns:loc="using:ArgoBooks.Localization"
             mc:Ignorable="d" d:DesignWidth="400" d:DesignHeight="300"
             x:Class="ArgoBooks.Modals.SaveErrorModal"
             x:CompileBindings="False">

    <controls:ModalOverlay IsOpen="{Binding HasSaveError}">
        <controls:ModalOverlay.ModalContent>
            <Border HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Width="400"
                    Background="{DynamicResource SurfaceBrush}"
                    CornerRadius="12"
                    BoxShadow="0 8 32 0 #40000000">
                <StackPanel Margin="24" Spacing="20">
                    <!-- Error Icon and Message -->
                    <StackPanel HorizontalAlignment="Center" Spacing="16">
                        <Border Background="#fef2f2"
                                CornerRadius="50"
                                Width="64" Height="64"
                                HorizontalAlignment="Center">
                            <PathIcon Data="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"
                                      Width="32" Height="32"
                                      Foreground="{DynamicResource ErrorBrush}"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center" />
                        </Border>
                        <TextBlock Text="{loc:Loc 'Unable to Save'}"
                                   FontSize="18"
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource TextPrimaryBrush}"
                                   HorizontalAlignment="Center" />
                        <TextBlock Text="{Binding SaveErrorMessage}"
                                   FontSize="14"
                                   Foreground="{DynamicResource TextSecondaryBrush}"
                                   TextWrapping="Wrap"
                                   TextAlignment="Center"
                                   HorizontalAlignment="Center" />
                    </StackPanel>

                    <!-- Buttons -->
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="12">
                        <Button Classes="secondary-button"
                                Content="{loc:Loc 'Cancel'}"
                                Command="{Binding DismissSaveErrorCommand}"
                                IsEnabled="{Binding !IsSavingTransaction}" />
                        <Button Classes="primary-button"
                                Command="{Binding RetrySaveCommand}"
                                IsEnabled="{Binding !IsSavingTransaction}">
                            <StackPanel Orientation="Horizontal" Spacing="6">
                                <!-- Retry icon - hidden when saving -->
                                <PathIcon Data="M17.65 6.35A7.958 7.958 0 0 0 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0 1 12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"
                                          Width="16" Height="16"
                                          IsVisible="{Binding !IsSavingTransaction}" />
                                <!-- Loading spinner - shown when saving -->
                                <PathIcon Data="M12 4V2A10 10 0 0 0 2 12h2a8 8 0 0 1 8-8z"
                                          Width="16" Height="16"
                                          IsVisible="{Binding IsSavingTransaction}" />
                                <TextBlock Text="{loc:Loc 'Retry'}"
                                           IsVisible="{Binding !IsSavingTransaction}" />
                                <TextBlock Text="{loc:Loc 'Retrying...'}"
                                           IsVisible="{Binding IsSavingTransaction}" />
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </StackPanel>
            </Border>
        </controls:ModalOverlay.ModalContent>
    </controls:ModalOverlay>
</UserControl>
