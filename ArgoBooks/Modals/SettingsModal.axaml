<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:ArgoBooks.ViewModels"
             xmlns:local="using:ArgoBooks.Converters"
             xmlns:icons="using:ArgoBooks"
             xmlns:controls="using:ArgoBooks.Controls"
             xmlns:loc="using:ArgoBooks.Localization"
             xmlns:modals="using:ArgoBooks.Modals"
             mc:Ignorable="d" d:DesignWidth="600" d:DesignHeight="550"
             x:Class="ArgoBooks.Modals.SettingsModal"
             x:DataType="vm:SettingsModalViewModel">

    <Design.DataContext>
        <vm:SettingsModalViewModel />
    </Design.DataContext>

    <Panel>
        <controls:ModalOverlay IsOpen="{Binding IsOpen}"
                               ClosingCommand="{Binding CloseCommand}">
            <controls:ModalOverlay.ModalContent>
                <!-- Modal Container -->
                <Border Background="{DynamicResource SurfaceBrush}"
                BorderBrush="{DynamicResource BorderBrush}"
                BorderThickness="1"
                CornerRadius="12"
                Width="750"
                Height="700"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                BoxShadow="0 8 32 0 #40000000">

            <Grid RowDefinitions="Auto,*,Auto">
                <!-- Header -->
                <Border Grid.Row="0"
                        Padding="24,20"
                        BorderBrush="{DynamicResource BorderBrush}"
                        BorderThickness="0,0,0,1">
                    <Grid ColumnDefinitions="*,Auto">
                        <TextBlock Grid.Column="0"
                                   Text="{loc:Loc Settings}"
                                   FontSize="18"
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource TextPrimaryBrush}" />
                        <Button Grid.Column="1"
                                Classes="icon-button"
                                Command="{Binding CloseCommand}">
                            <PathIcon Data="{x:Static icons:Icons.Close}"
                                      Width="20" Height="20" />
                        </Button>
                    </Grid>
                </Border>

                <!-- Body with Tabs -->
                <TabControl Grid.Row="1"
                            SelectedIndex="{Binding SelectedTabIndex}"
                            Margin="0">
                    <!-- General Tab -->
                    <TabItem Header="{loc:Loc General}">
                        <ScrollViewer VerticalScrollBarVisibility="Auto" Margin="24,20,16,20" Padding="0,0,8,0">
                            <StackPanel Spacing="20">
                                <!-- Language -->
                                <StackPanel Spacing="6">
                                    <TextBlock Text="{loc:Loc Language}"
                                               FontSize="13"
                                               FontWeight="Medium"
                                               Foreground="{DynamicResource TextSecondaryBrush}" />
                                    <controls:SearchableDropdown ItemsSource="{Binding Languages}"
                                                                  SelectedItem="{Binding SelectedLanguage}"
                                                                  PriorityItems="{Binding PriorityLanguages}"
                                                                  Placeholder="{loc:Loc 'Search languages...'}" />
                                </StackPanel>

                                <!-- Currency -->
                                <StackPanel Spacing="6">
                                    <TextBlock Text="{loc:Loc Currency}"
                                               FontSize="13"
                                               FontWeight="Medium"
                                               Foreground="{DynamicResource TextSecondaryBrush}" />
                                    <controls:SearchableDropdown ItemsSource="{Binding Currencies}"
                                                                  SelectedItem="{Binding SelectedCurrency}"
                                                                  PriorityItems="{Binding PriorityCurrencies}"
                                                                  Placeholder="{loc:Loc 'Search currencies...'}" />
                                </StackPanel>

                                <!-- Date Format -->
                                <StackPanel Spacing="6">
                                    <TextBlock Text="{loc:Loc 'Date Format'}"
                                               FontSize="13"
                                               FontWeight="Medium"
                                               Foreground="{DynamicResource TextSecondaryBrush}" />
                                    <ComboBox ItemsSource="{Binding DateFormats}"
                                              SelectedItem="{Binding SelectedDateFormat}"
                                              Classes="form-combobox" />
                                </StackPanel>

                                <!-- Time Zone -->
                                <StackPanel Spacing="6">
                                    <TextBlock Text="{loc:Loc 'Time Zone'}"
                                               FontSize="13"
                                               FontWeight="Medium"
                                               Foreground="{DynamicResource TextSecondaryBrush}" />
                                    <controls:SearchableDropdown ItemsSource="{Binding AllTimeZones}"
                                                                  SelectedItem="{Binding SelectedTimeZone}"
                                                                  PriorityItems="{Binding PriorityTimeZones}"
                                                                  DisplayMemberPath="DisplayName"
                                                                  Placeholder="{loc:Loc 'Search timezones...'}" />
                                </StackPanel>

                                <!-- Time Format -->
                                <StackPanel Spacing="6">
                                    <TextBlock Text="{loc:Loc 'Time Format'}"
                                               FontSize="13"
                                               FontWeight="Medium"
                                               Foreground="{DynamicResource TextSecondaryBrush}" />
                                    <Border Background="{DynamicResource SurfaceAltBrush}"
                                            CornerRadius="6"
                                            Padding="4"
                                            HorizontalAlignment="Left">
                                        <StackPanel Orientation="Horizontal" Spacing="4">
                                            <Button Content="12h"
                                                    Command="{Binding SelectTimeFormatCommand}"
                                                    CommandParameter="12h"
                                                    Classes="time-format-toggle"
                                                    Classes.selected="{Binding Is12HourFormat}" />
                                            <Button Content="24h"
                                                    Command="{Binding SelectTimeFormatCommand}"
                                                    CommandParameter="24h"
                                                    Classes="time-format-toggle"
                                                    Classes.selected="{Binding Is24HourFormat}" />
                                        </StackPanel>
                                    </Border>
                                </StackPanel>

                                <!-- Chart Settings -->
                                <StackPanel Spacing="6" Margin="0,8,0,0">
                                    <TextBlock Text="{loc:Loc 'Max Pie Chart Slices'}"
                                               FontSize="13"
                                               FontWeight="Medium"
                                               Foreground="{DynamicResource TextSecondaryBrush}" />
                                    <StackPanel Orientation="Horizontal" Spacing="12">
                                        <ComboBox ItemsSource="{Binding MaxPieSlicesOptions}"
                                                  SelectedItem="{Binding MaxPieSlices}"
                                                  Classes="form-combobox"
                                                  Width="100" />
                                        <TextBlock Text="{loc:Loc 'Additional items will be grouped into ''Other'''}"
                                                   FontSize="12"
                                                   Foreground="{DynamicResource TextTertiaryBrush}"
                                                   VerticalAlignment="Center" />
                                    </StackPanel>
                                </StackPanel>

                                <!-- Privacy Section -->
                                <StackPanel Spacing="8" Margin="0,8,0,0">
                                    <TextBlock Text="{loc:Loc Privacy}"
                                               FontSize="13"
                                               FontWeight="Medium"
                                               Foreground="{DynamicResource TextSecondaryBrush}" />

                                    <!-- Anonymous Data Collection Toggle -->
                                    <Border Background="{DynamicResource SurfaceAltBrush}"
                                            CornerRadius="8"
                                            Padding="16">
                                        <Grid ColumnDefinitions="*,Auto">
                                            <StackPanel Grid.Column="0" Spacing="4">
                                                <TextBlock Text="{loc:Loc 'Anonymous Data Collection'}"
                                                           FontSize="14"
                                                           FontWeight="Medium"
                                                           Foreground="{DynamicResource TextPrimaryBrush}" />
                                                <TextBlock Text="{loc:Loc 'Help improve Argo Books by sharing anonymous usage data'}"
                                                           FontSize="12"
                                                           Foreground="{DynamicResource TextTertiaryBrush}"
                                                           TextWrapping="Wrap" />
                                            </StackPanel>
                                            <ToggleSwitch Grid.Column="1"
                                                          IsChecked="{Binding AnonymousDataCollection}"
                                                          VerticalAlignment="Center" />
                                        </Grid>
                                    </Border>

                                    <!-- Telemetry Data Management (only visible when data collection is enabled) -->
                                    <Border Background="{DynamicResource SurfaceAltBrush}"
                                            CornerRadius="8"
                                            Padding="16"
                                            IsVisible="{Binding AnonymousDataCollection}">
                                        <StackPanel Spacing="12">
                                            <StackPanel Spacing="4">
                                                <TextBlock Text="{loc:Loc 'Collected Data'}"
                                                           FontSize="14"
                                                           FontWeight="Medium"
                                                           Foreground="{DynamicResource TextPrimaryBrush}" />
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                <Button Classes="secondary-button"
                                                        Content="{loc:Loc 'View Data'}"
                                                        Command="{Binding ExportTelemetryDataCommand}"
                                                        IsEnabled="{Binding !IsExportingTelemetry}"
                                                        Padding="12,6" />
                                                <Button Classes="danger-button"
                                                        Content="{loc:Loc 'Delete All Data'}"
                                                        Command="{Binding DeleteTelemetryDataCommand}"
                                                        IsEnabled="{Binding !IsDeletingTelemetry}"
                                                        Padding="12,6" />
                                            </StackPanel>
                                        </StackPanel>
                                    </Border>
                                </StackPanel>
                            </StackPanel>
                        </ScrollViewer>
                    </TabItem>

                    <!-- Notifications Tab -->
                    <TabItem Header="{loc:Loc Notifications}">
                        <ScrollViewer VerticalScrollBarVisibility="Auto" Margin="24,20,16,20" Padding="0,0,8,0">
                            <StackPanel Spacing="4">
                                <TextBlock Text="{loc:Loc 'Configure notification preferences'}"
                                           FontSize="13"
                                           Foreground="{DynamicResource TextTertiaryBrush}"
                                           Margin="0,0,0,16" />

                                <!-- Low Stock Alert -->
                                <Border Background="{DynamicResource SurfaceAltBrush}"
                                        CornerRadius="8"
                                        Padding="16">
                                    <Grid ColumnDefinitions="*,Auto" MinHeight="40">
                                        <StackPanel Grid.Column="0" Spacing="2" VerticalAlignment="Center">
                                            <TextBlock Text="{loc:Loc 'Low Stock Alert'}"
                                                       FontSize="14"
                                                       FontWeight="Medium"
                                                       Foreground="{DynamicResource TextPrimaryBrush}" />
                                            <TextBlock Text="{loc:Loc 'Get notified when inventory is running low'}"
                                                       FontSize="12"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </StackPanel>
                                        <ToggleSwitch Grid.Column="1"
                                                      IsChecked="{Binding LowStockAlert}"
                                                      VerticalAlignment="Center" />
                                    </Grid>
                                </Border>

                                <!-- Out of Stock Alert -->
                                <Border Background="{DynamicResource SurfaceAltBrush}"
                                        CornerRadius="8"
                                        Padding="16">
                                    <Grid ColumnDefinitions="*,Auto" MinHeight="40">
                                        <StackPanel Grid.Column="0" Spacing="2" VerticalAlignment="Center">
                                            <TextBlock Text="{loc:Loc 'Out of Stock Alert'}"
                                                       FontSize="14"
                                                       FontWeight="Medium"
                                                       Foreground="{DynamicResource TextPrimaryBrush}" />
                                            <TextBlock Text="{loc:Loc 'Get notified when inventory runs out'}"
                                                       FontSize="12"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </StackPanel>
                                        <ToggleSwitch Grid.Column="1"
                                                      IsChecked="{Binding OutOfStockAlert}"
                                                      VerticalAlignment="Center" />
                                    </Grid>
                                </Border>

                                <!-- Invoice Overdue -->
                                <Border Background="{DynamicResource SurfaceAltBrush}"
                                        CornerRadius="8"
                                        Padding="16">
                                    <Grid ColumnDefinitions="*,Auto" MinHeight="40">
                                        <StackPanel Grid.Column="0" Spacing="2" VerticalAlignment="Center">
                                            <TextBlock Text="{loc:Loc 'Invoice Overdue'}"
                                                       FontSize="14"
                                                       FontWeight="Medium"
                                                       Foreground="{DynamicResource TextPrimaryBrush}" />
                                            <TextBlock Text="{loc:Loc 'Get notified when invoices become overdue'}"
                                                       FontSize="12"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </StackPanel>
                                        <ToggleSwitch Grid.Column="1"
                                                      IsChecked="{Binding InvoiceOverdue}"
                                                      VerticalAlignment="Center" />
                                    </Grid>
                                </Border>

                                <!-- Rental Overdue -->
                                <Border Background="{DynamicResource SurfaceAltBrush}"
                                        CornerRadius="8"
                                        Padding="16">
                                    <Grid ColumnDefinitions="*,Auto" MinHeight="40">
                                        <StackPanel Grid.Column="0" Spacing="2" VerticalAlignment="Center">
                                            <TextBlock Text="{loc:Loc 'Rental Overdue'}"
                                                       FontSize="14"
                                                       FontWeight="Medium"
                                                       Foreground="{DynamicResource TextPrimaryBrush}" />
                                            <TextBlock Text="{loc:Loc 'Get notified when rentals become overdue'}"
                                                       FontSize="12"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </StackPanel>
                                        <ToggleSwitch Grid.Column="1"
                                                      IsChecked="{Binding RentalOverdue}"
                                                      VerticalAlignment="Center" />
                                    </Grid>
                                </Border>

                                <!-- Unsaved Changes Reminder -->
                                <Border Background="{DynamicResource SurfaceAltBrush}"
                                        CornerRadius="8"
                                        Padding="16">
                                    <StackPanel Spacing="12">
                                        <Grid ColumnDefinitions="*,Auto" MinHeight="40">
                                            <StackPanel Grid.Column="0" Spacing="2" VerticalAlignment="Center">
                                                <TextBlock Text="{loc:Loc 'Unsaved Changes Reminder'}"
                                                           FontSize="14"
                                                           FontWeight="Medium"
                                                           Foreground="{DynamicResource TextPrimaryBrush}" />
                                                <TextBlock Text="{loc:Loc 'Show a reminder when changes are unsaved'}"
                                                           FontSize="12"
                                                           Foreground="{DynamicResource TextTertiaryBrush}" />
                                            </StackPanel>
                                            <ToggleSwitch Grid.Column="1"
                                                          IsChecked="{Binding UnsavedChangesReminder}"
                                                          VerticalAlignment="Center" />
                                        </Grid>
                                        <StackPanel Orientation="Horizontal" Spacing="8"
                                                    IsVisible="{Binding UnsavedChangesReminder}">
                                            <TextBlock Text="{loc:Loc 'Show after'}"
                                                       FontSize="13"
                                                       Foreground="{DynamicResource TextSecondaryBrush}"
                                                       VerticalAlignment="Center" />
                                            <ComboBox SelectedItem="{Binding UnsavedChangesReminderMinutes}"
                                                      ItemsSource="{Binding ReminderMinuteOptions}"
                                                      Width="70"
                                                      VerticalAlignment="Center" />
                                            <TextBlock Text="{loc:Loc 'minutes'}"
                                                       FontSize="13"
                                                       Foreground="{DynamicResource TextSecondaryBrush}"
                                                       VerticalAlignment="Center" />
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </ScrollViewer>
                    </TabItem>

                    <!-- Appearance Tab -->
                    <TabItem Header="{loc:Loc Appearance}">
                        <ScrollViewer VerticalScrollBarVisibility="Auto" Margin="24,20,16,20" Padding="0,0,8,0">
                            <StackPanel Spacing="24" HorizontalAlignment="Center">
                                <!-- Theme -->
                                <StackPanel Spacing="12">
                                    <TextBlock Text="{loc:Loc Theme}"
                                               FontSize="14"
                                               FontWeight="Medium"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                    <StackPanel Orientation="Horizontal" Spacing="16">
                                        <!-- Light Theme -->
                                        <Button Classes="theme-selector"
                                                Command="{Binding SelectThemeCommand}"
                                                CommandParameter="Light">
                                            <Grid RowDefinitions="Auto,Auto">
                                                <Border Grid.Row="0"
                                                        Width="100" Height="60"
                                                        Background="#FFFFFF"
                                                        CornerRadius="6"
                                                        ClipToBounds="True">
                                                    <Border.BorderThickness>
                                                        <Binding Path="SelectedTheme">
                                                            <Binding.Converter>
                                                                <local:StringEqualsConverter CompareValue="Light" TrueValue="2" FalseValue="1" />
                                                            </Binding.Converter>
                                                        </Binding>
                                                    </Border.BorderThickness>
                                                    <Border.BorderBrush>
                                                        <MultiBinding Converter="{x:Static local:Converters.ThemeBorderBrushMulti}" ConverterParameter="Light">
                                                            <Binding Path="SelectedTheme" />
                                                            <Binding Path="SelectedAccentColor" />
                                                        </MultiBinding>
                                                    </Border.BorderBrush>
                                                    <StackPanel Margin="10" Spacing="6">
                                                        <Border Height="10" Background="#E5E7EB" CornerRadius="2" />
                                                        <Border Height="8" Width="50" Background="#E5E7EB" CornerRadius="2" HorizontalAlignment="Left" />
                                                    </StackPanel>
                                                </Border>
                                                <TextBlock Grid.Row="1"
                                                           Text="{loc:Loc Light}"
                                                           FontSize="12"
                                                           HorizontalAlignment="Center"
                                                           Margin="0,8,0,0"
                                                           Foreground="{DynamicResource TextSecondaryBrush}" />
                                            </Grid>
                                        </Button>

                                        <!-- Dark Theme -->
                                        <Button Classes="theme-selector"
                                                Command="{Binding SelectThemeCommand}"
                                                CommandParameter="Dark">
                                            <Grid RowDefinitions="Auto,Auto">
                                                <Border Grid.Row="0"
                                                        Width="100" Height="60"
                                                        Background="#1F2937"
                                                        CornerRadius="6"
                                                        ClipToBounds="True">
                                                    <Border.BorderThickness>
                                                        <Binding Path="SelectedTheme">
                                                            <Binding.Converter>
                                                                <local:StringEqualsConverter CompareValue="Dark" TrueValue="2" FalseValue="1" />
                                                            </Binding.Converter>
                                                        </Binding>
                                                    </Border.BorderThickness>
                                                    <Border.BorderBrush>
                                                        <MultiBinding Converter="{x:Static local:Converters.ThemeBorderBrushMulti}" ConverterParameter="Dark">
                                                            <Binding Path="SelectedTheme" />
                                                            <Binding Path="SelectedAccentColor" />
                                                        </MultiBinding>
                                                    </Border.BorderBrush>
                                                    <StackPanel Margin="10" Spacing="6">
                                                        <Border Height="10" Background="#374151" CornerRadius="2" />
                                                        <Border Height="8" Width="50" Background="#374151" CornerRadius="2" HorizontalAlignment="Left" />
                                                    </StackPanel>
                                                </Border>
                                                <TextBlock Grid.Row="1"
                                                           Text="{loc:Loc Dark}"
                                                           FontSize="12"
                                                           HorizontalAlignment="Center"
                                                           Margin="0,8,0,0"
                                                           Foreground="{DynamicResource TextSecondaryBrush}" />
                                            </Grid>
                                        </Button>

                                        <!-- System Theme -->
                                        <Button Classes="theme-selector"
                                                Command="{Binding SelectThemeCommand}"
                                                CommandParameter="System">
                                            <Grid RowDefinitions="Auto,Auto">
                                                <Border Grid.Row="0"
                                                        Width="100" Height="60"
                                                        CornerRadius="6"
                                                        ClipToBounds="True">
                                                    <Border.BorderThickness>
                                                        <Binding Path="SelectedTheme">
                                                            <Binding.Converter>
                                                                <local:StringEqualsConverter CompareValue="System" TrueValue="2" FalseValue="1" />
                                                            </Binding.Converter>
                                                        </Binding>
                                                    </Border.BorderThickness>
                                                    <Border.BorderBrush>
                                                        <MultiBinding Converter="{x:Static local:Converters.ThemeBorderBrushMulti}" ConverterParameter="System">
                                                            <Binding Path="SelectedTheme" />
                                                            <Binding Path="SelectedAccentColor" />
                                                        </MultiBinding>
                                                    </Border.BorderBrush>
                                                    <Grid>
                                                        <Border Background="#FFFFFF" CornerRadius="6,0,0,6" HorizontalAlignment="Left" Width="50" />
                                                        <Border Background="#1F2937" CornerRadius="0,6,6,0" HorizontalAlignment="Right" Width="50" />
                                                    </Grid>
                                                </Border>
                                                <TextBlock Grid.Row="1"
                                                           Text="{loc:Loc System}"
                                                           FontSize="12"
                                                           HorizontalAlignment="Center"
                                                           Margin="0,8,0,0"
                                                           Foreground="{DynamicResource TextSecondaryBrush}" />
                                            </Grid>
                                        </Button>
                                    </StackPanel>
                                </StackPanel>

                                <!-- Accent Color -->
                                <StackPanel Spacing="12">
                                    <TextBlock Text="{loc:Loc 'Accent Color'}"
                                               FontSize="14"
                                               FontWeight="Medium"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />
                                    <StackPanel Orientation="Horizontal" Spacing="12">
                                        <!-- Blue -->
                                        <Button Classes="color-button"
                                                Command="{Binding SelectAccentColorCommand}"
                                                CommandParameter="Blue">
                                            <Grid>
                                                <Border Width="48" Height="48" CornerRadius="24" Background="#3B82F6">
                                                    <PathIcon Data="{x:Static icons:Icons.Check}"
                                                              Width="20" Height="20" Foreground="White">
                                                        <PathIcon.IsVisible>
                                                            <Binding Path="SelectedAccentColor">
                                                                <Binding.Converter>
                                                                    <local:StringEqualsConverter CompareValue="Blue" />
                                                                </Binding.Converter>
                                                            </Binding>
                                                        </PathIcon.IsVisible>
                                                    </PathIcon>
                                                </Border>
                                            </Grid>
                                        </Button>
                                        <!-- Green -->
                                        <Button Classes="color-button"
                                                Command="{Binding SelectAccentColorCommand}"
                                                CommandParameter="Green">
                                            <Grid>
                                                <Border Width="48" Height="48" CornerRadius="24" Background="#10B981">
                                                    <PathIcon Data="{x:Static icons:Icons.Check}"
                                                              Width="20" Height="20" Foreground="White">
                                                        <PathIcon.IsVisible>
                                                            <Binding Path="SelectedAccentColor">
                                                                <Binding.Converter>
                                                                    <local:StringEqualsConverter CompareValue="Green" />
                                                                </Binding.Converter>
                                                            </Binding>
                                                        </PathIcon.IsVisible>
                                                    </PathIcon>
                                                </Border>
                                            </Grid>
                                        </Button>
                                        <!-- Purple -->
                                        <Button Classes="color-button"
                                                Command="{Binding SelectAccentColorCommand}"
                                                CommandParameter="Purple">
                                            <Grid>
                                                <Border Width="48" Height="48" CornerRadius="24" Background="#8B5CF6">
                                                    <PathIcon Data="{x:Static icons:Icons.Check}"
                                                              Width="20" Height="20" Foreground="White">
                                                        <PathIcon.IsVisible>
                                                            <Binding Path="SelectedAccentColor">
                                                                <Binding.Converter>
                                                                    <local:StringEqualsConverter CompareValue="Purple" />
                                                                </Binding.Converter>
                                                            </Binding>
                                                        </PathIcon.IsVisible>
                                                    </PathIcon>
                                                </Border>
                                            </Grid>
                                        </Button>
                                        <!-- Pink -->
                                        <Button Classes="color-button"
                                                Command="{Binding SelectAccentColorCommand}"
                                                CommandParameter="Pink">
                                            <Grid>
                                                <Border Width="48" Height="48" CornerRadius="24" Background="#EC4899">
                                                    <PathIcon Data="{x:Static icons:Icons.Check}"
                                                              Width="20" Height="20" Foreground="White">
                                                        <PathIcon.IsVisible>
                                                            <Binding Path="SelectedAccentColor">
                                                                <Binding.Converter>
                                                                    <local:StringEqualsConverter CompareValue="Pink" />
                                                                </Binding.Converter>
                                                            </Binding>
                                                        </PathIcon.IsVisible>
                                                    </PathIcon>
                                                </Border>
                                            </Grid>
                                        </Button>
                                        <!-- Orange -->
                                        <Button Classes="color-button"
                                                Command="{Binding SelectAccentColorCommand}"
                                                CommandParameter="Orange">
                                            <Grid>
                                                <Border Width="48" Height="48" CornerRadius="24" Background="#F97316">
                                                    <PathIcon Data="{x:Static icons:Icons.Check}"
                                                              Width="20" Height="20" Foreground="White">
                                                        <PathIcon.IsVisible>
                                                            <Binding Path="SelectedAccentColor">
                                                                <Binding.Converter>
                                                                    <local:StringEqualsConverter CompareValue="Orange" />
                                                                </Binding.Converter>
                                                            </Binding>
                                                        </PathIcon.IsVisible>
                                                    </PathIcon>
                                                </Border>
                                            </Grid>
                                        </Button>
                                        <!-- Teal -->
                                        <Button Classes="color-button"
                                                Command="{Binding SelectAccentColorCommand}"
                                                CommandParameter="Teal">
                                            <Grid>
                                                <Border Width="48" Height="48" CornerRadius="24" Background="#14B8A6">
                                                    <PathIcon Data="{x:Static icons:Icons.Check}"
                                                              Width="20" Height="20" Foreground="White">
                                                        <PathIcon.IsVisible>
                                                            <Binding Path="SelectedAccentColor">
                                                                <Binding.Converter>
                                                                    <local:StringEqualsConverter CompareValue="Teal" />
                                                                </Binding.Converter>
                                                            </Binding>
                                                        </PathIcon.IsVisible>
                                                    </PathIcon>
                                                </Border>
                                            </Grid>
                                        </Button>
                                    </StackPanel>
                                </StackPanel>
                            </StackPanel>
                        </ScrollViewer>
                    </TabItem>

                    <!-- Security Tab -->
                    <TabItem Header="{loc:Loc Security}">
                        <ScrollViewer VerticalScrollBarVisibility="Auto" Margin="24,20,16,20" Padding="0,0,8,0">
                            <StackPanel Spacing="16">
                                <!-- Password - No password set -->
                                <Border Background="{DynamicResource SurfaceAltBrush}"
                                        CornerRadius="8"
                                        Padding="16"
                                        IsVisible="{Binding !HasPassword}">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <StackPanel Grid.Column="0" Spacing="2">
                                            <TextBlock Text="{loc:Loc Password}"
                                                       FontSize="14"
                                                       FontWeight="Medium"
                                                       Foreground="{DynamicResource TextPrimaryBrush}" />
                                            <TextBlock Text="{loc:Loc 'Add a password to protect your company file'}"
                                                       FontSize="12"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </StackPanel>
                                        <Button Grid.Column="1"
                                                Classes="primary-button"
                                                Content="{loc:Loc 'Add Password'}"
                                                Command="{Binding OpenAddPasswordCommand}"
                                                VerticalAlignment="Center" />
                                    </Grid>
                                </Border>

                                <!-- Password - Has password set -->
                                <Border Background="{DynamicResource SurfaceAltBrush}"
                                        CornerRadius="8"
                                        Padding="16"
                                        IsVisible="{Binding HasPassword}">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <StackPanel Grid.Column="0" Spacing="2">
                                            <TextBlock Text="{loc:Loc Password}"
                                                       FontSize="14"
                                                       FontWeight="Medium"
                                                       Foreground="{DynamicResource TextPrimaryBrush}" />
                                            <TextBlock Text="{loc:Loc 'Your company file is password protected'}"
                                                       FontSize="12"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </StackPanel>
                                        <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                                            <Button Classes="secondary-button"
                                                    Content="{loc:Loc Change}"
                                                    Command="{Binding OpenChangePasswordCommand}"
                                                    VerticalAlignment="Center" />
                                            <Button Classes="danger-button"
                                                    Content="{loc:Loc Remove}"
                                                    Command="{Binding OpenRemovePasswordCommand}"
                                                    VerticalAlignment="Center" />
                                        </StackPanel>
                                    </Grid>
                                </Border>

                                <!-- Windows Hello -->
                                <Border Background="{DynamicResource SurfaceAltBrush}"
                                        CornerRadius="8"
                                        Padding="16">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <StackPanel Grid.Column="0" Spacing="2">
                                            <TextBlock Text="{loc:Loc 'Windows Hello'}"
                                                       FontSize="14"
                                                       FontWeight="Medium"
                                                       Foreground="{DynamicResource TextPrimaryBrush}" />
                                            <!-- Show description when enabled (has both Standard and password) -->
                                            <TextBlock Text="{loc:Loc 'Use fingerprint or face recognition to unlock'}"
                                                       FontSize="12"
                                                       Foreground="{DynamicResource TextTertiaryBrush}"
                                                       IsVisible="{Binding CanEnableWindowsHello}" />
                                            <!-- Show "requires password" message when has Standard but no password -->
                                            <TextBlock Text="{loc:Loc 'Requires a password to be set first'}"
                                                       FontSize="12"
                                                       Foreground="{DynamicResource TextSecondaryBrush}"
                                                       IsVisible="{Binding NeedsPasswordForWindowsHello}" />
                                            <!-- Show "requires Standard" message when doesn't have Standard plan -->
                                            <TextBlock Text="{loc:Loc 'Requires Standard plan or higher'}"
                                                       FontSize="12"
                                                       Foreground="{DynamicResource TextSecondaryBrush}"
                                                       IsVisible="{Binding !HasStandard}" />
                                        </StackPanel>
                                        <!-- Toggle when user has standard AND password -->
                                        <ToggleSwitch Grid.Column="1"
                                                      IsChecked="{Binding WindowsHelloEnabled}"
                                                      IsVisible="{Binding CanEnableWindowsHello}"
                                                      VerticalAlignment="Center" />
                                        <!-- Upgrade button when user doesn't have standard -->
                                        <Button Grid.Column="1"
                                                Classes="primary-button"
                                                Content="{loc:Loc 'Upgrade Now'}"
                                                Command="{Binding UpgradeNowCommand}"
                                                IsVisible="{Binding !HasStandard}"
                                                VerticalAlignment="Center"
                                                Padding="12,6" />
                                    </Grid>
                                </Border>

                                <!-- File Encryption -->
                                <Border Background="{DynamicResource SurfaceAltBrush}"
                                        CornerRadius="8"
                                        Padding="16">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <StackPanel Grid.Column="0" Spacing="2">
                                            <TextBlock Text="{loc:Loc 'File Encryption'}"
                                                       FontSize="14"
                                                       FontWeight="Medium"
                                                       Foreground="{DynamicResource TextPrimaryBrush}" />
                                            <TextBlock Text="{loc:Loc 'Encrypt company files with AES-256'}"
                                                       FontSize="12"
                                                       Foreground="{DynamicResource TextTertiaryBrush}" />
                                        </StackPanel>
                                        <ToggleSwitch Grid.Column="1"
                                                      IsChecked="{Binding FileEncryptionEnabled}"
                                                      VerticalAlignment="Center" />
                                    </Grid>
                                </Border>

                                <!-- Auto-Lock -->
                                <StackPanel Spacing="6">
                                    <TextBlock Text="{loc:Loc Auto-Lock}"
                                               FontSize="13"
                                               FontWeight="Medium"
                                               Foreground="{DynamicResource TextSecondaryBrush}" />
                                    <ComboBox ItemsSource="{Binding AutoLockOptions}"
                                              SelectedItem="{Binding SelectedAutoLock}"
                                              Classes="form-combobox">
                                        <ComboBox.ItemTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Converter={StaticResource TranslateConverter}}" />
                                            </DataTemplate>
                                        </ComboBox.ItemTemplate>
                                    </ComboBox>
                                    <TextBlock Text="{loc:Loc 'Automatically lock the application after inactivity'}"
                                               FontSize="12"
                                               Foreground="{DynamicResource TextTertiaryBrush}" />
                                </StackPanel>
                            </StackPanel>
                        </ScrollViewer>
                    </TabItem>
                </TabControl>

                <!-- Footer -->
                <Border Grid.Row="2"
                        Padding="24,16"
                        BorderBrush="{DynamicResource BorderBrush}"
                        BorderThickness="0,1,0,0">
                    <StackPanel Orientation="Horizontal"
                                HorizontalAlignment="Right"
                                Spacing="12">
                        <Button Classes="secondary-button"
                                Content="{loc:Loc Cancel}"
                                Command="{Binding CloseCommand}" />
                        <Button Classes="primary-button"
                                Content="{loc:Loc 'Save Changes'}"
                                Command="{Binding SaveCommand}" />
                    </StackPanel>
                </Border>
            </Grid>
                </Border>
            </controls:ModalOverlay.ModalContent>
        </controls:ModalOverlay>

        <!-- Add Password Modal -->
        <controls:ModalOverlay IsOpen="{Binding IsAddPasswordModalOpen}">
            <controls:ModalOverlay.ModalContent>
                <Border Background="{DynamicResource SurfaceBrush}"
                    BorderBrush="{DynamicResource BorderBrush}"
                    BorderThickness="1"
                    CornerRadius="12"
                    Width="400"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    BoxShadow="0 8 32 0 #40000000">
                <StackPanel>
                    <Border Padding="20,16" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,0,0,1">
                        <TextBlock Text="{loc:Loc 'Add Password'}" FontSize="16" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" />
                    </Border>
                    <StackPanel Margin="20" Spacing="16">
                        <TextBlock Text="{loc:Loc 'Create a password to protect your company file. You''ll need this password to open the file.'}"
                                   FontSize="13" Foreground="{DynamicResource TextSecondaryBrush}" TextWrapping="Wrap" />
                        <StackPanel Spacing="6">
                            <TextBlock Text="{loc:Loc 'New Password'}" FontSize="13" FontWeight="Medium" Foreground="{DynamicResource TextSecondaryBrush}" />
                            <Border Background="{DynamicResource SurfaceBrush}"
                                    BorderBrush="{DynamicResource BorderBrush}"
                                    BorderThickness="1"
                                    CornerRadius="6">
                                <Grid ColumnDefinitions="*,Auto">
                                    <TextBox Grid.Column="0"
                                             Text="{Binding NewPassword}"
                                             RevealPassword="{Binding IsNewPasswordVisible}"
                                             Classes="password-field" />
                                    <Button Grid.Column="1"
                                            Classes="eye-toggle"
                                            Command="{Binding ToggleNewPasswordVisibilityCommand}">
                                        <PathIcon Data="{Binding NewPasswordVisibilityIcon}" Width="16" Height="16" />
                                    </Button>
                                </Grid>
                            </Border>
                        </StackPanel>
                        <StackPanel Spacing="6">
                            <TextBlock Text="{loc:Loc 'Confirm Password'}" FontSize="13" FontWeight="Medium" Foreground="{DynamicResource TextSecondaryBrush}" />
                            <Border Background="{DynamicResource SurfaceBrush}"
                                    BorderBrush="{DynamicResource BorderBrush}"
                                    BorderThickness="1"
                                    CornerRadius="6">
                                <Grid ColumnDefinitions="*,Auto">
                                    <TextBox Grid.Column="0"
                                             Text="{Binding ConfirmPassword}"
                                             RevealPassword="{Binding IsConfirmPasswordVisible}"
                                             Classes="password-field" />
                                    <Button Grid.Column="1"
                                            Classes="eye-toggle"
                                            Command="{Binding ToggleConfirmPasswordVisibilityCommand}">
                                        <PathIcon Data="{Binding ConfirmPasswordVisibilityIcon}" Width="16" Height="16" />
                                    </Button>
                                </Grid>
                            </Border>
                        </StackPanel>
                        <TextBlock Text="{Binding PasswordError}" FontSize="12" Foreground="#dc2626"
                                   IsVisible="{Binding PasswordError, Converter={x:Static StringConverters.IsNotNullOrEmpty}}" />
                    </StackPanel>
                    <Border Padding="20,16" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,1,0,0">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Spacing="12">
                            <Button Classes="secondary-button" Content="{loc:Loc Cancel}" Command="{Binding ClosePasswordModalCommand}" />
                            <Button Classes="primary-button" Content="{loc:Loc 'Add Password'}" Command="{Binding ConfirmAddPasswordCommand}" />
                        </StackPanel>
                    </Border>
                </StackPanel>
                </Border>
            </controls:ModalOverlay.ModalContent>
        </controls:ModalOverlay>

        <!-- Change Password Modal -->
        <controls:ModalOverlay IsOpen="{Binding IsChangePasswordModalOpen}">
            <controls:ModalOverlay.ModalContent>
                <Border Background="{DynamicResource SurfaceBrush}"
                    BorderBrush="{DynamicResource BorderBrush}"
                    BorderThickness="1"
                    CornerRadius="12"
                    Width="400"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    BoxShadow="0 8 32 0 #40000000">
                <StackPanel>
                    <Border Padding="20,16" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,0,0,1">
                        <TextBlock Text="{loc:Loc 'Change Password'}" FontSize="16" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" />
                    </Border>
                    <StackPanel Margin="20" Spacing="16">
                        <StackPanel Spacing="6">
                            <TextBlock Text="{loc:Loc 'Current Password'}" FontSize="13" FontWeight="Medium" Foreground="{DynamicResource TextSecondaryBrush}" />
                            <Border Background="{DynamicResource SurfaceBrush}"
                                    BorderBrush="{DynamicResource BorderBrush}"
                                    BorderThickness="1"
                                    CornerRadius="6">
                                <Grid ColumnDefinitions="*,Auto">
                                    <TextBox Grid.Column="0"
                                             x:Name="ChangeCurrentPasswordTextBox"
                                             Text="{Binding CurrentPassword}"
                                             RevealPassword="{Binding IsCurrentPasswordVisible}"
                                             Classes="password-field" />
                                    <Button Grid.Column="1"
                                            Classes="eye-toggle"
                                            Command="{Binding ToggleCurrentPasswordVisibilityCommand}">
                                        <PathIcon Data="{Binding CurrentPasswordVisibilityIcon}" Width="16" Height="16" />
                                    </Button>
                                </Grid>
                            </Border>
                        </StackPanel>
                        <StackPanel Spacing="6">
                            <TextBlock Text="{loc:Loc 'New Password'}" FontSize="13" FontWeight="Medium" Foreground="{DynamicResource TextSecondaryBrush}" />
                            <Border Background="{DynamicResource SurfaceBrush}"
                                    BorderBrush="{DynamicResource BorderBrush}"
                                    BorderThickness="1"
                                    CornerRadius="6">
                                <Grid ColumnDefinitions="*,Auto">
                                    <TextBox Grid.Column="0"
                                             Text="{Binding NewPassword}"
                                             RevealPassword="{Binding IsNewPasswordVisible}"
                                             Classes="password-field" />
                                    <Button Grid.Column="1"
                                            Classes="eye-toggle"
                                            Command="{Binding ToggleNewPasswordVisibilityCommand}">
                                        <PathIcon Data="{Binding NewPasswordVisibilityIcon}" Width="16" Height="16" />
                                    </Button>
                                </Grid>
                            </Border>
                        </StackPanel>
                        <StackPanel Spacing="6">
                            <TextBlock Text="{loc:Loc 'Confirm New Password'}" FontSize="13" FontWeight="Medium" Foreground="{DynamicResource TextSecondaryBrush}" />
                            <Border Background="{DynamicResource SurfaceBrush}"
                                    BorderBrush="{DynamicResource BorderBrush}"
                                    BorderThickness="1"
                                    CornerRadius="6">
                                <Grid ColumnDefinitions="*,Auto">
                                    <TextBox Grid.Column="0"
                                             Text="{Binding ConfirmPassword}"
                                             RevealPassword="{Binding IsConfirmPasswordVisible}"
                                             Classes="password-field" />
                                    <Button Grid.Column="1"
                                            Classes="eye-toggle"
                                            Command="{Binding ToggleConfirmPasswordVisibilityCommand}">
                                        <PathIcon Data="{Binding ConfirmPasswordVisibilityIcon}" Width="16" Height="16" />
                                    </Button>
                                </Grid>
                            </Border>
                        </StackPanel>
                        <TextBlock Text="{Binding PasswordError}" FontSize="12" Foreground="#dc2626"
                                   IsVisible="{Binding PasswordError, Converter={x:Static StringConverters.IsNotNullOrEmpty}}" />
                    </StackPanel>
                    <Border Padding="20,16" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,1,0,0">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Spacing="12">
                            <Button Classes="secondary-button" Content="{loc:Loc Cancel}" Command="{Binding ClosePasswordModalCommand}" />
                            <Button Classes="primary-button" Content="{loc:Loc 'Change Password'}" Command="{Binding ConfirmChangePasswordCommand}" />
                        </StackPanel>
                    </Border>
                </StackPanel>
                </Border>
            </controls:ModalOverlay.ModalContent>
        </controls:ModalOverlay>

        <!-- Remove Password Modal -->
        <controls:ModalOverlay IsOpen="{Binding IsRemovePasswordModalOpen}">
            <controls:ModalOverlay.ModalContent>
                <Border Background="{DynamicResource SurfaceBrush}"
                    BorderBrush="{DynamicResource BorderBrush}"
                    BorderThickness="1"
                    CornerRadius="12"
                    Width="400"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    BoxShadow="0 8 32 0 #40000000">
                <StackPanel>
                    <Border Padding="20,16" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,0,0,1">
                        <TextBlock Text="{loc:Loc 'Remove Password'}" FontSize="16" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimaryBrush}" />
                    </Border>
                    <StackPanel Margin="20" Spacing="16">
                        <TextBlock Text="{loc:Loc 'Are you sure you want to remove password protection? Your company file will no longer be protected.'}"
                                   FontSize="13" Foreground="{DynamicResource TextSecondaryBrush}" TextWrapping="Wrap" />
                        <StackPanel Spacing="6">
                            <TextBlock Text="{loc:Loc 'Current Password'}" FontSize="13" FontWeight="Medium" Foreground="{DynamicResource TextSecondaryBrush}" />
                            <Border Background="{DynamicResource SurfaceBrush}"
                                    BorderBrush="{DynamicResource BorderBrush}"
                                    BorderThickness="1"
                                    CornerRadius="6">
                                <Grid ColumnDefinitions="*,Auto">
                                    <TextBox Grid.Column="0"
                                             x:Name="RemoveCurrentPasswordTextBox"
                                             Text="{Binding CurrentPassword}"
                                             RevealPassword="{Binding IsCurrentPasswordVisible}"
                                             Classes="password-field" />
                                    <Button Grid.Column="1"
                                            Classes="eye-toggle"
                                            Command="{Binding ToggleCurrentPasswordVisibilityCommand}">
                                        <PathIcon Data="{Binding CurrentPasswordVisibilityIcon}" Width="16" Height="16" />
                                    </Button>
                                </Grid>
                            </Border>
                        </StackPanel>
                        <TextBlock Text="{Binding PasswordError}" FontSize="12" Foreground="#dc2626"
                                   IsVisible="{Binding PasswordError, Converter={x:Static StringConverters.IsNotNullOrEmpty}}" />
                    </StackPanel>
                    <Border Padding="20,16" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="0,1,0,0">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Spacing="12">
                            <Button Classes="secondary-button" Content="{loc:Loc Cancel}" Command="{Binding ClosePasswordModalCommand}" />
                            <Button Classes="danger-button" Content="{loc:Loc 'Remove Password'}" Command="{Binding ConfirmRemovePasswordCommand}" />
                        </StackPanel>
                    </Border>
                </StackPanel>
                </Border>
            </controls:ModalOverlay.ModalContent>
        </controls:ModalOverlay>

        <!-- Currency Error Modal -->
        <modals:CurrencyErrorModal />
    </Panel>

    <UserControl.Styles>
        <!-- Password Field (borderless, for use inside bordered container) -->
        <Style Selector="TextBox.password-field">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Padding" Value="12,10" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}" />
            <Setter Property="PasswordChar" Value="*" />
        </Style>
        <Style Selector="TextBox.password-field /template/ Border#PART_BorderElement">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
        </Style>

        <!-- Eye Toggle Button (for password visibility) -->
        <Style Selector="Button.eye-toggle">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Width" Value="40" />
            <Setter Property="Height" Value="40" />
            <Setter Property="Padding" Value="0" />
            <Setter Property="CornerRadius" Value="0,6,6,0" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Margin" Value="0" />
        </Style>
        <Style Selector="Button.eye-toggle /template/ ContentPresenter#PART_ContentPresenter">
            <Setter Property="Background" Value="Transparent" />
        </Style>
        <Style Selector="Button.eye-toggle:pointerover /template/ ContentPresenter#PART_ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource SurfaceHoverBrush}" />
        </Style>
        <Style Selector="Button.eye-toggle PathIcon">
            <Setter Property="Foreground" Value="{DynamicResource TextSecondaryBrush}" />
        </Style>

        <!-- Color Button -->
        <Style Selector="Button.color-button">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Padding" Value="0" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Width" Value="48" />
            <Setter Property="Height" Value="48" />
        </Style>
        <Style Selector="Button.color-button /template/ ContentPresenter#PART_ContentPresenter">
            <Setter Property="Background" Value="Transparent" />
        </Style>
        <Style Selector="Button.color-button:pointerover /template/ ContentPresenter#PART_ContentPresenter">
            <Setter Property="Background" Value="Transparent" />
        </Style>

        <!-- Theme Selector Button -->
        <Style Selector="Button.theme-selector">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Padding" Value="0" />
            <Setter Property="Cursor" Value="Hand" />
        </Style>
        <Style Selector="Button.theme-selector /template/ ContentPresenter#PART_ContentPresenter">
            <Setter Property="Background" Value="Transparent" />
        </Style>
        <Style Selector="Button.theme-selector:pointerover /template/ ContentPresenter#PART_ContentPresenter">
            <Setter Property="Background" Value="Transparent" />
        </Style>

        <!-- TabControl - remove default underline and center tabs -->
        <Style Selector="TabControl">
            <Setter Property="Background" Value="Transparent" />
        </Style>
        <Style Selector="TabControl /template/ ItemsPresenter#PART_ItemsPresenter">
            <Setter Property="HorizontalAlignment" Value="Center" />
        </Style>
        <Style Selector="TabControl /template/ Border#PART_InnerBorder">
            <Setter Property="BorderThickness" Value="0" />
        </Style>

        <!-- Tab Item Styling -->
        <Style Selector="TabItem">
            <Setter Property="FontSize" Value="14" />
            <Setter Property="FontWeight" Value="Medium" />
            <Setter Property="Padding" Value="4,12,4,10" />
            <Setter Property="Margin" Value="8,0" />
            <Setter Property="Foreground" Value="{DynamicResource TextSecondaryBrush}" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Cursor" Value="Hand" />
        </Style>
        <Style Selector="TabItem:pointerover">
            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}" />
        </Style>
        <Style Selector="TabItem:pointerover /template/ ContentPresenter#PART_ContentPresenter">
            <Setter Property="TextBlock.Foreground" Value="{DynamicResource TextPrimaryBrush}" />
        </Style>
        <Style Selector="TabItem:selected">
            <Setter Property="Foreground" Value="{DynamicResource PrimaryBrush}" />
        </Style>
        <Style Selector="TabItem:selected /template/ ContentPresenter#PART_ContentPresenter">
            <Setter Property="TextBlock.Foreground" Value="{DynamicResource PrimaryBrush}" />
        </Style>
        <Style Selector="TabItem:selected /template/ Border#PART_SelectedPipe">
            <Setter Property="IsVisible" Value="True" />
            <Setter Property="Background" Value="{DynamicResource PrimaryBrush}" />
            <Setter Property="Height" Value="2" />
            <Setter Property="VerticalAlignment" Value="Bottom" />
            <Setter Property="Margin" Value="0,0,0,0" />
            <Setter Property="CornerRadius" Value="1" />
        </Style>

        <!-- Animated Checkbox -->
        <Style Selector="CheckBox">
            <Setter Property="Cursor" Value="Hand" />
        </Style>
        <Style Selector="CheckBox /template/ Border#NormalRectangle">
            <Setter Property="Transitions">
                <Transitions>
                    <BrushTransition Property="Background" Duration="0:0:0.15" />
                    <BrushTransition Property="BorderBrush" Duration="0:0:0.15" />
                </Transitions>
            </Setter>
        </Style>
        <Style Selector="CheckBox /template/ Path#CheckGlyph">
            <Setter Property="Transitions">
                <Transitions>
                    <DoubleTransition Property="Opacity" Duration="0:0:0.15" />
                    <TransformOperationsTransition Property="RenderTransform" Duration="0:0:0.15" Easing="CubicEaseOut" />
                </Transitions>
            </Setter>
            <Setter Property="Opacity" Value="0" />
            <Setter Property="RenderTransform" Value="scale(0.5)" />
            <Setter Property="RenderTransformOrigin" Value="0.5,0.5" />
        </Style>
        <Style Selector="CheckBox:checked /template/ Path#CheckGlyph">
            <Setter Property="Opacity" Value="1" />
            <Setter Property="RenderTransform" Value="scale(1)" />
        </Style>

        <!-- Time Format Toggle Buttons -->
        <Style Selector="Button.time-format-toggle">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Foreground" Value="{DynamicResource TextSecondaryBrush}" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Padding" Value="16,8" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="FontWeight" Value="Medium" />
            <Setter Property="CornerRadius" Value="4" />
            <Setter Property="Cursor" Value="Hand" />
        </Style>
        <Style Selector="Button.time-format-toggle /template/ ContentPresenter#PART_ContentPresenter">
            <Setter Property="Background" Value="Transparent" />
        </Style>
        <Style Selector="Button.time-format-toggle:pointerover /template/ ContentPresenter#PART_ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource SurfaceHoverBrush}" />
        </Style>
        <Style Selector="Button.time-format-toggle.selected">
            <Setter Property="Background" Value="{DynamicResource PrimaryBrush}" />
            <Setter Property="Foreground" Value="White" />
        </Style>
        <Style Selector="Button.time-format-toggle.selected /template/ ContentPresenter#PART_ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource PrimaryBrush}" />
        </Style>
        <Style Selector="Button.time-format-toggle.selected:pointerover /template/ ContentPresenter#PART_ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource PrimaryBrush}" />
            <Setter Property="Opacity" Value="0.9" />
        </Style>
    </UserControl.Styles>
</UserControl>
