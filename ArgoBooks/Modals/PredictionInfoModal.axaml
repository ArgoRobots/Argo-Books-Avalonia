<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:ArgoBooks.ViewModels"
             xmlns:controls="using:ArgoBooks.Controls"
             xmlns:icons="using:ArgoBooks"
             mc:Ignorable="d" d:DesignWidth="600" d:DesignHeight="700"
             x:Class="ArgoBooks.Modals.PredictionInfoModal"
             x:DataType="vm:PredictionInfoModalViewModel">

    <controls:ModalOverlay IsOpen="{Binding IsOpen}">
        <controls:ModalOverlay.ModalContent>
            <!-- Modal Container -->
            <Border Background="{DynamicResource SurfaceBrush}"
                BorderBrush="{DynamicResource BorderBrush}"
                BorderThickness="1"
                CornerRadius="12"
                MaxWidth="600"
                MaxHeight="750"
                Margin="40"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                BoxShadow="0 8 32 0 #40000000">

            <Grid RowDefinitions="Auto,*,Auto">
                <!-- Modal Header -->
                <Border Grid.Row="0"
                        Padding="24,20"
                        BorderBrush="{DynamicResource BorderBrush}"
                        BorderThickness="0,0,0,1">
                    <Grid ColumnDefinitions="*,Auto">
                        <StackPanel Grid.Column="0">
                            <TextBlock Text="How Predictions Work"
                                       FontSize="18"
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource TextPrimaryBrush}" />
                            <TextBlock Text="Smart forecasting powered by machine learning"
                                       FontSize="13"
                                       Foreground="{DynamicResource TextSecondaryBrush}" />
                        </StackPanel>
                        <Button Grid.Column="1"
                                Classes="icon-button"
                                Width="32" Height="32"
                                Command="{Binding CloseCommand}">
                            <PathIcon Data="{x:Static icons:Icons.Close}"
                                      Width="16" Height="16"
                                      Foreground="{DynamicResource TextSecondaryBrush}" />
                        </Button>
                    </Grid>
                </Border>

                <!-- Modal Content -->
                <ScrollViewer Grid.Row="1"
                              HorizontalScrollBarVisibility="Disabled">
                    <StackPanel Spacing="20" Margin="24">
                        <!-- How It Works -->
                        <StackPanel Spacing="8">
                            <TextBlock Text="How It Works"
                                       FontSize="14"
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource TextPrimaryBrush}" />
                            <TextBlock TextWrapping="Wrap"
                                       FontSize="13"
                                       Foreground="{DynamicResource TextSecondaryBrush}"
                                       Text="Our forecasting system uses multiple ML algorithms to predict future revenue, expenses, and customer growth. It continuously tests predictions against actual outcomes and adapts its methods based on what works best for your business. Everything runs locally - your data never leaves your computer." />
                        </StackPanel>

                        <!-- Key Features -->
                        <StackPanel Spacing="12">
                            <TextBlock Text="What Makes It Smart"
                                       FontSize="14"
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource TextPrimaryBrush}" />

                            <!-- Seasonal Patterns -->
                            <Border Background="{DynamicResource SurfaceAltBrush}"
                                    CornerRadius="8"
                                    Padding="16">
                                <Grid ColumnDefinitions="Auto,*">
                                    <Border Grid.Column="0"
                                            Width="36" Height="36"
                                            CornerRadius="8"
                                            Background="#EDE9FE"
                                            Margin="0,0,12,0"
                                            VerticalAlignment="Top">
                                        <PathIcon Data="{x:Static icons:Icons.Clock}"
                                                  Width="18" Height="18"
                                                  Foreground="{DynamicResource VioletBrush}" />
                                    </Border>
                                    <StackPanel Grid.Column="1" Spacing="4">
                                        <TextBlock Text="Seasonal Pattern Detection"
                                                   FontSize="13"
                                                   FontWeight="Medium"
                                                   Foreground="{DynamicResource TextPrimaryBrush}" />
                                        <TextBlock Text="Automatically detects if your business has patterns - like higher sales in December or slower months in summer. The forecast adjusts for these cycles."
                                                   FontSize="12"
                                                   TextWrapping="Wrap"
                                                   Foreground="{DynamicResource TextSecondaryBrush}" />
                                    </StackPanel>
                                </Grid>
                            </Border>

                            <!-- Trend Analysis -->
                            <Border Background="{DynamicResource SurfaceAltBrush}"
                                    CornerRadius="8"
                                    Padding="16">
                                <Grid ColumnDefinitions="Auto,*">
                                    <Border Grid.Column="0"
                                            Width="36" Height="36"
                                            CornerRadius="8"
                                            Background="{DynamicResource SuccessLightBrush}"
                                            Margin="0,0,12,0"
                                            VerticalAlignment="Top">
                                        <PathIcon Data="{x:Static icons:Icons.TrendUp}"
                                                  Width="18" Height="18"
                                                  Foreground="{DynamicResource SuccessBrush}" />
                                    </Border>
                                    <StackPanel Grid.Column="1" Spacing="4">
                                        <TextBlock Text="Trend Analysis"
                                                   FontSize="13"
                                                   FontWeight="Medium"
                                                   Foreground="{DynamicResource TextPrimaryBrush}" />
                                        <TextBlock Text="Understands whether your business is growing, stable, or declining - and factors this into predictions so they're not just based on averages."
                                                   FontSize="12"
                                                   TextWrapping="Wrap"
                                                   Foreground="{DynamicResource TextSecondaryBrush}" />
                                    </StackPanel>
                                </Grid>
                            </Border>

                            <!-- Accuracy Tracking -->
                            <Border Background="{DynamicResource SurfaceAltBrush}"
                                    CornerRadius="8"
                                    Padding="16">
                                <Grid ColumnDefinitions="Auto,*">
                                    <Border Grid.Column="0"
                                            Width="36" Height="36"
                                            CornerRadius="8"
                                            Background="{DynamicResource PrimaryLightBrush}"
                                            Margin="0,0,12,0"
                                            VerticalAlignment="Top">
                                        <PathIcon Data="{x:Static icons:Icons.Check}"
                                                  Width="18" Height="18"
                                                  Foreground="{DynamicResource PrimaryBrush}" />
                                    </Border>
                                    <StackPanel Grid.Column="1" Spacing="4">
                                        <TextBlock Text="Accuracy Tracking"
                                                   FontSize="13"
                                                   FontWeight="Medium"
                                                   Foreground="{DynamicResource TextPrimaryBrush}" />
                                        <TextBlock Text="Compares past predictions to what actually happened. Over time, you'll see how accurate the forecasts have been for your specific business."
                                                   FontSize="12"
                                                   TextWrapping="Wrap"
                                                   Foreground="{DynamicResource TextSecondaryBrush}" />
                                    </StackPanel>
                                </Grid>
                            </Border>

                            <!-- Historical Accuracy Explanation -->
                            <Border Background="{DynamicResource SurfaceAltBrush}"
                                    CornerRadius="8"
                                    Padding="16">
                                <Grid ColumnDefinitions="Auto,*">
                                    <Border Grid.Column="0"
                                            Width="36" Height="36"
                                            CornerRadius="8"
                                            Background="#F0FDF4"
                                            Margin="0,0,12,0"
                                            VerticalAlignment="Top">
                                        <PathIcon Data="{x:Static icons:Icons.DocumentNotes}"
                                                  Width="18" Height="18"
                                                  Foreground="#16A34A" />
                                    </Border>
                                    <StackPanel Grid.Column="1" Spacing="4">
                                        <TextBlock Text="How Accuracy is Calculated"
                                                   FontSize="13"
                                                   FontWeight="Medium"
                                                   Foreground="{DynamicResource TextPrimaryBrush}" />
                                        <TextBlock Text="The Historical Accuracy percentage shows how close predictions were to actual results. For example, 85% accuracy means predictions were typically within 15% of the actual values. It's calculated by comparing each past forecast to the actual outcome, then averaging the results."
                                                   FontSize="12"
                                                   TextWrapping="Wrap"
                                                   Foreground="{DynamicResource TextSecondaryBrush}" />
                                    </StackPanel>
                                </Grid>
                            </Border>

                            <!-- Adaptive Learning -->
                            <Border Background="{DynamicResource SurfaceAltBrush}"
                                    CornerRadius="8"
                                    Padding="16">
                                <Grid ColumnDefinitions="Auto,*">
                                    <Border Grid.Column="0"
                                            Width="36" Height="36"
                                            CornerRadius="8"
                                            Background="{DynamicResource ErrorLightBrush}"
                                            Margin="0,0,12,0"
                                            VerticalAlignment="Top">
                                        <PathIcon Data="{x:Static icons:Icons.CircleCheck}"
                                                  Width="18" Height="18"
                                                  Foreground="#EF4444" />
                                    </Border>
                                    <StackPanel Grid.Column="1" Spacing="4">
                                        <TextBlock Text="Adaptive Learning"
                                                   FontSize="13"
                                                   FontWeight="Medium"
                                                   Foreground="{DynamicResource TextPrimaryBrush}" />
                                        <TextBlock Text="The system learns which prediction method works best for your business. Methods that have been more accurate historically are weighted more heavily in future forecasts."
                                                   FontSize="12"
                                                   TextWrapping="Wrap"
                                                   Foreground="{DynamicResource TextSecondaryBrush}" />
                                    </StackPanel>
                                </Grid>
                            </Border>

                            <!-- Confidence Range -->
                            <Border Background="{DynamicResource SurfaceAltBrush}"
                                    CornerRadius="8"
                                    Padding="16">
                                <Grid ColumnDefinitions="Auto,*">
                                    <Border Grid.Column="0"
                                            Width="36" Height="36"
                                            CornerRadius="8"
                                            Background="{DynamicResource WarningLightBrush}"
                                            Margin="0,0,12,0"
                                            VerticalAlignment="Top">
                                        <PathIcon Data="{x:Static icons:Icons.BarChart}"
                                                  Width="18" Height="18"
                                                  Foreground="{DynamicResource WarningBrush}" />
                                    </Border>
                                    <StackPanel Grid.Column="1" Spacing="4">
                                        <TextBlock Text="Confidence Range"
                                                   FontSize="13"
                                                   FontWeight="Medium"
                                                   Foreground="{DynamicResource TextPrimaryBrush}" />
                                        <TextBlock Text="Shows a range (low to high estimate) instead of just one number. This gives you a realistic picture of what to expect."
                                                   FontSize="12"
                                                   TextWrapping="Wrap"
                                                   Foreground="{DynamicResource TextSecondaryBrush}" />
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </StackPanel>

                        <!-- Confidence Score -->
                        <StackPanel Spacing="8">
                            <TextBlock Text="Confidence Score"
                                       FontSize="14"
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource TextPrimaryBrush}" />
                            <TextBlock TextWrapping="Wrap"
                                       FontSize="13"
                                       Foreground="{DynamicResource TextSecondaryBrush}"
                                       Text="The confidence score (0-100%) tells you how reliable the prediction is likely to be:" />
                            <Grid ColumnDefinitions="*,*,*" Margin="0,8,0,0">
                                <Border Grid.Column="0" Background="{DynamicResource SuccessDarkBrush}" CornerRadius="6" Padding="12" Margin="0,0,4,0">
                                    <StackPanel HorizontalAlignment="Center" Spacing="4">
                                        <TextBlock Text="High" FontSize="16" FontWeight="SemiBold" Foreground="White" HorizontalAlignment="Center" />
                                        <TextBlock Text="80%+" FontSize="13" Foreground="White" Opacity="0.9" HorizontalAlignment="Center" />
                                        <TextBlock Text="Strong pattern" FontSize="11" Foreground="White" Opacity="0.7" HorizontalAlignment="Center" />
                                    </StackPanel>
                                </Border>
                                <Border Grid.Column="1" Background="{DynamicResource WarningDarkBrush}" CornerRadius="6" Padding="12" Margin="2,0">
                                    <StackPanel HorizontalAlignment="Center" Spacing="4">
                                        <TextBlock Text="Medium" FontSize="16" FontWeight="SemiBold" Foreground="White" HorizontalAlignment="Center" />
                                        <TextBlock Text="50-79%" FontSize="13" Foreground="White" Opacity="0.9" HorizontalAlignment="Center" />
                                        <TextBlock Text="Use as guide" FontSize="11" Foreground="White" Opacity="0.7" HorizontalAlignment="Center" />
                                    </StackPanel>
                                </Border>
                                <Border Grid.Column="2" Background="{DynamicResource ErrorDarkBrush}" CornerRadius="6" Padding="12" Margin="4,0,0,0">
                                    <StackPanel HorizontalAlignment="Center" Spacing="4">
                                        <TextBlock Text="Low" FontSize="16" FontWeight="SemiBold" Foreground="White" HorizontalAlignment="Center" />
                                        <TextBlock Text="&lt;50%" FontSize="13" Foreground="White" Opacity="0.9" HorizontalAlignment="Center" />
                                        <TextBlock Text="Limited data" FontSize="11" Foreground="White" Opacity="0.7" HorizontalAlignment="Center" />
                                    </StackPanel>
                                </Border>
                            </Grid>
                        </StackPanel>

                        <!-- Tips -->
                        <StackPanel Spacing="8">
                            <TextBlock Text="Tips for Better Predictions"
                                       FontSize="14"
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource TextPrimaryBrush}" />
                            <Border Background="{DynamicResource SurfaceAltBrush}"
                                    CornerRadius="8"
                                    Padding="16">
                                <StackPanel Spacing="8">
                                    <TextBlock Text="• More data = better predictions. 12+ months is ideal."
                                               FontSize="12"
                                               TextWrapping="Wrap"
                                               Foreground="{DynamicResource TextSecondaryBrush}" />
                                    <TextBlock Text="• The system improves over time as it learns from your data."
                                               FontSize="12"
                                               TextWrapping="Wrap"
                                               Foreground="{DynamicResource TextSecondaryBrush}" />
                                    <TextBlock Text="• Keep your records consistent and up to date."
                                               FontSize="12"
                                               TextWrapping="Wrap"
                                               Foreground="{DynamicResource TextSecondaryBrush}" />
                                    <TextBlock Text="• Use forecasts as a guide, not a guarantee."
                                               FontSize="12"
                                               TextWrapping="Wrap"
                                               Foreground="{DynamicResource TextSecondaryBrush}" />
                                </StackPanel>
                            </Border>
                        </StackPanel>

                        <!-- Important Note -->
                        <Border Background="{DynamicResource SurfaceAltBrush}"
                                CornerRadius="8"
                                Padding="16">
                            <Grid ColumnDefinitions="Auto,*">
                                <PathIcon Grid.Column="0"
                                          Data="{x:Static icons:Icons.Info}"
                                          Width="18" Height="18"
                                          Foreground="{DynamicResource TextTertiaryBrush}"
                                          VerticalAlignment="Top"
                                          Margin="0,2,12,0" />
                                <TextBlock Grid.Column="1"
                                           TextWrapping="Wrap"
                                           FontSize="12"
                                           Foreground="{DynamicResource TextSecondaryBrush}"
                                           Text="All calculations happen on your device. Your financial data is never sent to any external server or cloud service." />
                            </Grid>
                        </Border>
                    </StackPanel>
                </ScrollViewer>

                <!-- Modal Footer -->
                <Border Grid.Row="2"
                        Padding="24,16"
                        BorderBrush="{DynamicResource BorderBrush}"
                        BorderThickness="0,1,0,0">
                    <Button Classes="primary-button"
                            HorizontalAlignment="Right"
                            Command="{Binding CloseCommand}">
                        <TextBlock Text="Got it" />
                    </Button>
                </Border>
            </Grid>
            </Border>
        </controls:ModalOverlay.ModalContent>
    </controls:ModalOverlay>
</UserControl>
