<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:controls="using:ArgoBooks.Controls"
             mc:Ignorable="d" d:DesignWidth="200" d:DesignHeight="200"
             x:Class="ArgoBooks.Controls.ChartContextMenu"
             x:DataType="controls:ChartContextMenu">

    <controls:AnimatedContextMenu IsOpen="{Binding IsOpen, RelativeSource={RelativeSource AncestorType=controls:ChartContextMenu}}"
                                   MenuX="{Binding MenuX, RelativeSource={RelativeSource AncestorType=controls:ChartContextMenu}}"
                                   MenuY="{Binding MenuY, RelativeSource={RelativeSource AncestorType=controls:ChartContextMenu}}"
                                   CloseCommand="{Binding CloseCommand, RelativeSource={RelativeSource AncestorType=controls:ChartContextMenu}}">
        <controls:AnimatedContextMenu.MenuContent>
            <StackPanel Spacing="2" MinWidth="200">
                <!-- Save as Image -->
                <Button Classes="context-menu-item"
                        Command="{Binding SaveChartAsImageCommand, RelativeSource={RelativeSource AncestorType=controls:ChartContextMenu}}">
                    <StackPanel Orientation="Horizontal" Spacing="10">
                        <PathIcon Data="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"
                                  Width="16" Height="16"
                                  Foreground="{DynamicResource TextSecondaryBrush}" />
                        <TextBlock Text="Save as Image"
                                   FontSize="13"
                                   Foreground="{DynamicResource TextPrimaryBrush}" />
                    </StackPanel>
                </Button>

                <!-- Export Options (hidden for geomaps) -->
                <StackPanel Spacing="2"
                            IsVisible="{Binding ShowExportOptions, RelativeSource={RelativeSource AncestorType=controls:ChartContextMenu}}">
                    <!-- Separator -->
                    <Border Height="1"
                            Background="{DynamicResource BorderBrush}"
                            Margin="4,4" />

                    <!-- Export to Google Sheets -->
                    <Button Classes="context-menu-item"
                            Command="{Binding ExportToGoogleSheetsCommand, RelativeSource={RelativeSource AncestorType=controls:ChartContextMenu}}">
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <PathIcon Data="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"
                                      Width="16" Height="16"
                                      Foreground="{DynamicResource TextSecondaryBrush}" />
                            <TextBlock Text="Export to Google Sheets"
                                       FontSize="13"
                                       Foreground="{DynamicResource TextPrimaryBrush}" />
                        </StackPanel>
                    </Button>

                    <!-- Export to Excel -->
                    <Button Classes="context-menu-item"
                            Command="{Binding ExportToExcelCommand, RelativeSource={RelativeSource AncestorType=controls:ChartContextMenu}}">
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <PathIcon Data="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"
                                      Width="16" Height="16"
                                      Foreground="{DynamicResource TextSecondaryBrush}" />
                            <TextBlock Text="Export to Excel"
                                       FontSize="13"
                                       Foreground="{DynamicResource TextPrimaryBrush}" />
                        </StackPanel>
                    </Button>
                </StackPanel>

                <!-- Reset Zoom (hidden for pie charts and geomaps) -->
                <StackPanel Spacing="2"
                            IsVisible="{Binding ShowResetZoom, RelativeSource={RelativeSource AncestorType=controls:ChartContextMenu}}">
                    <!-- Separator -->
                    <Border Height="1"
                            Background="{DynamicResource BorderBrush}"
                            Margin="4,4" />

                    <!-- Reset Zoom -->
                    <Button Classes="context-menu-item"
                            Command="{Binding ResetChartZoomCommand, RelativeSource={RelativeSource AncestorType=controls:ChartContextMenu}}">
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <PathIcon Data="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"
                                      Width="16" Height="16"
                                      Foreground="{DynamicResource TextSecondaryBrush}" />
                            <TextBlock Text="Reset Zoom"
                                       FontSize="13"
                                       Foreground="{DynamicResource TextPrimaryBrush}" />
                        </StackPanel>
                    </Button>
                </StackPanel>
            </StackPanel>
        </controls:AnimatedContextMenu.MenuContent>
    </controls:AnimatedContextMenu>
</UserControl>
